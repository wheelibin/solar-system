{"version":3,"sources":["app/models/SolarSystem.ts","components/LoadingIndicator/LoadingIndicator.tsx","components/PlanetDataSheet/PlanetDataSheet.tsx","components/App/App.tsx","app/utils/planetNames.ts","app/utils/Random.ts","app/utils/SolarSystemGenerator.ts","app/utils/NoiseMapGenerator.ts","app/entities/Entity.ts","app/entities/Moon.ts","app/entities/ClassM.ts","app/entities/Star.ts","app/entities/Earth.ts","app/entities/AsteroidBelt.ts","app/SolarSystemApp.ts","index.tsx"],"names":["EntityType","verbs","adjectives","nouns","randomArrayValue","array","min","max","length","Math","floor","random","LoadingIndicator","show","className","PlanetDataSheet","planet","properties","name","radius","toLocaleString","satellites","orbitRadius","orbitSpeed","orbitInclanation","map","prop","App","solarSystemApp","useState","isLoading","setIsLoading","undefined","selectedPlanet","setSelectedPlanet","useEffect","init","onInitialising","handleInitialising","onInitialised","handleInitialised","onSelectPlanet","handleSelectPlanet","planetNames","Random","seed","mt19937","factory","rand","getRandom","this","getRandomInt","x0","y0","z0","u","v","theta","PI","phi","acos","sin","cos","solarSystemValues","seedIndexes","SolarSystemGenerator","entityId","solarSystem","stars","starRadius","entityType","Star","id","getNextId","position","terrainHeight","orbitEntityId","orbitDirection","orbitStartPosition","spinSpeed","getRandomFloat","spinDirection","coinToss","starIndex","star","baseSeed","numberOfPlanets","planetOrbitRadiuses","createPlanetOrbitRadiuses","planetIndex","planetRadius","createPlanet","numberOfMoons","moonOrbitRadiuses","Array","fill","item","index","sort","a","b","moonIndex","moonRadius","moon","createMoon","push","ratio","every","s","Planet","r1","r2","numberOfAsteroids","AsteroidBelt","maxRadius","itemCount","distanceFromStar","furthestPlanetOrbitRadius","positionInSystem","i","po1","distanceBetween","randomOrbitDirection","randomSpinSpeed","Moon","rgb","getRandomRgb","planetName","getRandomFromArray","NoiseMapGenerator","noiseGenerator","SimplexNoise","width","height","x","y","noise","getMixedFrequencyNoise","pow","makeSeamlessVertically","makeSeamlessHorizontally","frequency","xOffset","yOffset","_x","_y","amplitude","n","noise2D","frequencies","sumOfAmplitudes","reduce","previous","getNoise","noiseMap","stitchWidth","o","MathUtils","lerp","stitchHeight","k","ceil","s1","s2","c","Entity","params","entity","sphere","orbit","textureWidth","textureHeight","maxTerrainHeight","material","heightMapTexture","colourMapTexture","loader","TextureLoader","sphereGeometry","orbitGeometry","texture","labelContext","labelTexture","labelSprite","labelScaleVector","Vector3","labelAspectRatio","Group","terrainMaps","generateTerrainMaps","CanvasTexture","heightMap","canvas","mapping","EquirectangularReflectionMapping","MeshPhongMaterial","bumpMap","bumpScale","displacementMap","displacementScale","shininess","specular","texturePath","loadAsync","MeshBasicMaterial","color","colour","SphereBufferGeometry","Mesh","castShadow","receiveShadow","hasLabel","addLabel","add","orbitEntity","orbitEntityPos","createOrbitCircle","set","z","rotation","degToRad","clock","speed","camera","showLabels","getElapsedTime","perSecond","visible","scale","subVectors","onShow","dispose","_dispose","heightMapContext","getCanvasContext","heightMapImageData","createImageData","heightMapData","data","colourMapContext","colourMapImageData","colourMapData","acc","cur","generateNoiseMap","colourValue","heightColour","ci","mapColour","getMapColour","putImageData","level","lerpColour","dark","light","col1","col2","convertToColor","toArray","Color","setRGB","ctx","document","createElement","getContext","fillStyle","fillRect","BufferGeometry","verts","LineBasicMaterial","opacity","transparent","vertices","Float32Array","setAttribute","BufferAttribute","Line","font","textAlign","fillText","fontSize","Texture","needsUpdate","spriteMaterial","SpriteMaterial","Sprite","r","g","rgba","ClassM","colours","oceanDark","getRandomColour","oceanLight","beachDark","beachLight","forestDark","forestLight","jungleDark","jungleLight","savannahDark","savannahLight","desertDark","desertLight","snowDark","snowLight","getColourForHeight","getRangeColour","colIndex","Earth","Number","minScale","maxScale","count","InstancedMesh","mesh","Euler","quaternion","Quaternion","matrix","Matrix4","mod","randomDirection","setFromEuler","scaleAmount","compose","setMatrixAt","animationDuration","ReactDOM","render","StrictMode","isRunning","scene","Clock","bodies","renderer","orbitControls","stats","showPlanetId","cameraInitialPosition","cameraLookAtTarget","cameraPositionVector","spaceTexture","gui","guiViewActionsFolder","guiPlanetsFolder","planetPositionVector","ambientLight","pointLight","cameraReachedTarget","options","simulationSpeed","showOrbits","followPlanetName","trueScale","showPlanetLabels","showAsteroidBelts","showStats","buttonHandlers","resetView","newSeed","randInt","changeSeed","regenSolarSystem","updateDisplay","clearScene","generate","_init","then","animate","PointLight","ambientLightIntensity","power","physicallyCorrectLights","decay","AmbientLight","renderRealisticSolarSystem","renderSolarSystem","divideScalar","planets","filter","addFolder","open","p","onChange","onFollowPlanetNameChange","toggleOrbits","toggleAsteroidBelts","handleShowStatsChange","requestAnimationFrame","forEach","body","update","find","getWorldPosition","lookAt","target","tweenUpdate","removeFolder","destroy","error","clear","Tween","to","duration","easing","Easing","Quintic","InOut","start","onUpdate","dom","style","display","handleShowPlanet","tween","onComplete","Cubic","Out","abs","ab","viewScale","starEntity","create","starSatellite","planetParams","planetEntity","moonEntity","asteroidBelt","starSatellites","cloneDeep","planetMoonRadius","prevStarSatellite","prevPlanetMoonRadius","Scene","background","setHex","CubeTextureLoader","load","Camera","PerspectiveCamera","window","innerWidth","innerHeight","WebGLRenderer","powerPreference","antialias","setSize","setPixelRatio","devicePixelRatio","shadowMap","enabled","appendChild","domElement","OrbitControls","enableDamping","Stats","GUI","newSeedButton","parentElement","onFinishChange","getElementById"],"mappings":"+MAgCYA,E,2DCxBNC,EAAQ,CACZ,eACA,YACA,WACA,YACA,YACA,cACA,WACA,SACA,aACA,eACA,YACA,aACA,cACA,YACA,SACA,cACA,cACA,eACA,cACA,aACA,YAGIC,EAAa,CACjB,eACA,cACA,aACA,cACA,aACA,aACA,YACA,gBACA,kBACA,WACA,gBACA,YACA,mBACA,kBACA,cACA,WACA,cACA,aAGIC,EAAQ,CACZ,gBACA,eACA,2BACA,gBACA,kBACA,sBACA,gBACA,YACA,cACA,eACA,eACA,iBACA,oBACA,UACA,UACA,SACA,iBACA,sBACA,gBACA,gBACA,2BACA,gBACA,cACA,gBACA,cACA,kBAQIC,EAAmB,SAACC,GACxB,OAAOA,GANsBC,EAMM,EANOC,EAMJF,EAAMG,OAAS,EAJ9CC,KAAKC,MAAMD,KAAKE,UAAYJ,EAAMD,EAAM,GAAKA,KAFxB,IAACA,EAAaC,GAa/BK,EAAoC,SAAC,GAChD,OAD6D,EAAXC,KAK3C,qBAAKC,UAAU,oBAAf,SARD,GAAN,OAAUV,EAAiBH,GAA3B,YAAqCG,EAAiBF,GAAtD,YAAqEE,EAAiBD,GAAtF,SAKS,MC1FEY,G,OAAmC,SAAC,GAAgB,IAAdC,EAAa,EAAbA,OACjD,IAAKA,EACH,OAAO,KAGT,IAAMC,EAAa,CACjB,CAAC,OAAQD,EAAOE,MAChB,CAAC,iBAAkC,EAAhBF,EAAOG,QAAYC,kBACtC,CAAC,QAASJ,EAAOK,WAAWb,QAC5B,CAAC,sBAAuBQ,EAAOM,YAAYF,kBAC3C,CAAC,uBAAwBX,KAAKC,MAAMM,EAAOO,YAAYH,kBACvD,CAAC,6BAA2BJ,EAAOQ,mBAGrC,OACE,sBAAKV,UAAU,mBAAf,UACE,6CAEA,oBAAIA,UAAU,kCAAd,SACGG,EAAWQ,KAAI,SAACC,GAAD,OACd,qBAAkBZ,UAAU,6BAA5B,UACE,iCAASY,EAAK,KACd,4BAAIA,EAAK,OAFFA,EAAK,cCjBXC,EAAuB,SAAC,GAAwB,IAAtBC,EAAqB,EAArBA,eACrC,EAAkCC,oBAAS,GAA3C,mBAAOC,EAAP,KAAkBC,EAAlB,KACA,EAA4CF,wBAAwCG,GAApF,mBAAOC,EAAP,KAAuBC,EAAvB,KAEAC,qBAAU,WACRP,EAAeQ,MAAK,GACpBR,EAAeS,eAAiBC,EAChCV,EAAeW,cAAgBC,EAC/BZ,EAAea,eAAiBC,IAC/B,CAACd,IAEJ,IAAMU,EAAqB,WACzBP,GAAa,IAGTS,EAAoB,WACxBT,GAAa,IAGTW,EAAqB,SAAC1B,GAC1BkB,EAAkBlB,IAGpB,OACE,qCACE,cAAC,EAAD,CAAkBH,KAAMiB,IACxB,cAAC,EAAD,CAAiBd,OAAQiB,Q,2IHJnBjC,O,eAAAA,I,mBAAAA,I,eAAAA,I,gCAAAA,M,KI/BL,IAAM2C,EAAc,CACzB,WACA,WACA,UACA,WACA,WACA,SACA,UACA,UACA,QACA,SACA,WACA,YACA,YACA,WACA,QACA,QACA,SACA,SACA,WACA,SACA,YACA,SACA,SACA,WACA,SACA,OACA,WACA,UACA,YACA,SACA,YACA,aACA,SACA,UACA,UACA,SACA,UACA,UACA,UACA,cACA,cACA,aACA,aACA,SACA,WACA,aACA,YACA,UACA,WACA,cACA,aACA,WACA,YACA,SACA,SACA,UACA,OACA,OACA,QACA,OACA,QACA,QACA,QACA,UACA,QACA,QACA,SACA,UACA,UACA,aACA,WACA,YACA,UACA,WACA,UACA,WACA,WACA,QACA,SACA,QACA,QACA,SACA,UACA,SACA,SACA,WACA,UACA,UACA,SACA,cACA,UACA,SACA,SACA,WACA,SACA,WACA,UACA,YACA,YACA,SACA,aACA,UACA,UACA,aACA,gBACA,WACA,YACA,WACA,UACA,WACA,WACA,WACA,WACA,QACA,QACA,cACA,OACA,QACA,SACA,YACA,UACA,SACA,SACA,WACA,YACA,QACA,OACA,SACA,eACA,SACA,UACA,SACA,WACA,WACA,QACA,SACA,WACA,SACA,WACA,SACA,WACA,UACA,YACA,UACA,QACA,cACA,YACA,SACA,SACA,SACA,OACA,WACA,QACA,UACA,WACA,WACA,QACA,SACA,SACA,OACA,UACA,SACA,UACA,UACA,SACA,YACA,WACA,OACA,KACA,MACA,QACA,SACA,WACA,UACA,UACA,OACA,MACA,OACA,WACA,aACA,SACA,QACA,UACA,WACA,YACA,aACA,WACA,UACA,UACA,QACA,QACA,SACA,WACA,QACA,UACA,QACA,SACA,WACA,OACA,OACA,UACA,WACA,WACA,QACA,SACA,SACA,QACA,WACA,WACA,gBACA,UACA,SACA,SACA,SACA,UACA,OACA,QACA,QACA,WACA,aACA,UACA,MACA,SACA,SACA,gBACA,SACA,SACA,QACA,QACA,SACA,QACA,YACA,YACA,aACA,OACA,OACA,WACA,WACA,QACA,OACA,SACA,WACA,QACA,SACA,gBACA,gBACA,cACA,aACA,YACA,aACA,aACA,SACA,aACA,QACA,UACA,WACA,WACA,QACA,SACA,UACA,SACA,kBACA,KACA,UACA,QACA,YACA,UACA,OACA,SACA,QACA,QACA,UACA,OACA,UACA,WACA,QACA,UACA,SACA,QACA,UACA,iBACA,QACA,QACA,SACA,QACA,aACA,UACA,QACA,OACA,SACA,UACA,OACA,QACA,iBACA,MACA,QACA,OACA,SACA,SACA,QACA,OACA,QACA,YACA,UACA,QACA,QACA,SACA,UACA,WACA,YACA,SACA,WACA,WACA,YACA,SACA,SACA,QACA,QACA,UACA,QACA,WACA,YACA,QACA,aACA,QACA,cACA,WACA,OACA,OACA,QACA,WACA,QACA,SACA,UACA,YACA,QACA,UACA,cACA,SACA,SACA,SACA,SACA,OACA,QACA,SACA,QACA,KACA,YACA,WACA,SACA,MACA,WACA,SACA,UACA,UACA,iBACA,UACA,WACA,UACA,QACA,SACA,aACA,cACA,MACA,UACA,QACA,UACA,UACA,YACA,KACA,SACA,MACA,MACA,UACA,QACA,WACA,SACA,QACA,YACA,cACA,YACA,UACA,UACA,SACA,SACA,UACA,WACA,WACA,YACA,YACA,cACA,UACA,UACA,WACA,WACA,cACA,YACA,UACA,aACA,UACA,YACA,YACA,WACA,OACA,SACA,YACA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","file":"static/js/main.aaced874.chunk.js","sourcesContent":["export type SolarSystemEntity = {\n  id: number;\n  name: string;\n  entityType: EntityType;\n  seed: number[];\n  radius: number;\n  terrainHeight: number;\n  satellites: SolarSystemEntity[];\n  orbitEntityId: number;\n  orbitRadius: number;\n  orbitDirection: number;\n  orbitSpeed: number;\n  orbitInclanation: number;\n  orbitStartPosition: number;\n  spinSpeed: number;\n  spinDirection: number;\n\n  // A number between 0-1 representing the position in the entire system\n  // i.e. distanceFromStar / furthestPlanetDistanceFromStar\n  positionInSystem?: number;\n  position?: [number, number, number];\n  rgb?: [number, number, number];\n\n  // for multi item entities (e.g. asteroid belt)\n  maxRadius?: number;\n  itemCount?: number;\n};\n\nexport type SolarSystem = {\n  stars: SolarSystemEntity[];\n};\n\nexport enum EntityType {\n  Star,\n  Planet,\n  Moon,\n  AsteroidBelt,\n}\n","import React from \"react\";\n\nimport \"./LoadingIndicator.css\";\n\ntype Props = {\n  show?: boolean;\n};\n\nconst verbs = [\n  \"annihilating\",\n  \"balancing\",\n  \"charging\",\n  \"colliding\",\n  \"combining\",\n  \"dispatching\",\n  \"exciting\",\n  \"firing\",\n  \"generating\",\n  \"initialising\",\n  \"inflating\",\n  \"isolating \",\n  \"manifesting\",\n  \"measuring\",\n  \"mining\",\n  \"normalising\",\n  \"randomising\",\n  \"scintilating\",\n  \"stabilising\",\n  \"televising\",\n  \"unifying\",\n];\n\nconst adjectives = [\n  \"asynchronous\",\n  \"correlating\",\n  \"crystaline\",\n  \"high-energy\",\n  \"homologous\",\n  \"isomorphic\",\n  \"molecular\",\n  \"multi-valent \",\n  \"non-interacting\",\n  \"resonant\",\n  \"self-coupling\",\n  \"subatomic\",\n  \"supersymmetrical\",\n  \"superconductive\",\n  \"synchronous\",\n  \"unstable\",\n  \"vibrational\",\n  \"zero-spin\",\n];\n\nconst nouns = [\n  \"astral fields\",\n  \"atomic gases\",\n  \"bose-einstein condensate\",\n  \"consciousness\",\n  \"design elements\",\n  \"elementry particles\",\n  \"gravity wells\",\n  \"harmonics\",\n  \"higgs field\",\n  \"light quanta\",\n  \"meson clouds\",\n  \"neutron masses\",\n  \"phase transitions\",\n  \"photons\",\n  \"physics\",\n  \"plasma\",\n  \"quantum states\",\n  \"relativistic speeds\",\n  \"scalar fields\",\n  \"singularities\",\n  \"space-time fragmentation\",\n  \"string theory\",\n  \"superfluids\",\n  \"vector bosons\",\n  \"warp fields\",\n  \"wave functions\",\n];\n\nconst randomIntFromInterval = (min: number, max: number) => {\n  // min and max included\n  return Math.floor(Math.random() * (max - min + 1) + min);\n};\n\nconst randomArrayValue = (array: any[]) => {\n  return array[randomIntFromInterval(0, array.length - 1)];\n};\n\nconst getRandomMessage = () => {\n  return `${randomArrayValue(verbs)} ${randomArrayValue(adjectives)} ${randomArrayValue(nouns)}...`;\n};\n\nexport const LoadingIndicator: React.FC<Props> = ({ show }) => {\n  if (!show) {\n    return null;\n  }\n\n  return <div className=\"loading-indicator\">{getRandomMessage()}</div>;\n};\n","import { SolarSystemEntity } from \"../../app/models/SolarSystem\";\nimport \"./PlanetDataSheet.css\";\n\ntype Props = {\n  planet?: SolarSystemEntity;\n};\n\nexport const PlanetDataSheet: React.FC<Props> = ({ planet }) => {\n  if (!planet) {\n    return null;\n  }\n\n  const properties = [\n    [\"Name\", planet.name],\n    [\"Diameter (km)\", (planet.radius * 2).toLocaleString()],\n    [\"Moons\", planet.satellites.length],\n    [\"Orbit Distance (km)\", planet.orbitRadius.toLocaleString()],\n    [\"Orbital Speed (km/h)\", Math.floor(planet.orbitSpeed).toLocaleString()],\n    [\"Orbital Inclanation (°)\", planet.orbitInclanation],\n  ];\n\n  return (\n    <div className=\"planet-datasheet\">\n      <h2>Planet Info</h2>\n\n      <ul className=\"planet-datasheet__property-list\">\n        {properties.map((prop) => (\n          <li key={prop[0]} className=\"planet-datasheet__property\">\n            <strong>{prop[0]}</strong>\n            <p>{prop[1]}</p>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n};\n","import React, { useEffect, useState } from \"react\";\nimport { LoadingIndicator } from \"../LoadingIndicator/LoadingIndicator\";\nimport { SolarSystemApp } from \"../../app/SolarSystemApp\";\nimport { PlanetDataSheet } from \"../PlanetDataSheet/PlanetDataSheet\";\nimport { SolarSystemEntity } from \"../../app/models/SolarSystem\";\n\ntype Props = {\n  solarSystemApp: SolarSystemApp;\n};\n\nexport const App: React.FC<Props> = ({ solarSystemApp }) => {\n  const [isLoading, setIsLoading] = useState(true);\n  const [selectedPlanet, setSelectedPlanet] = useState<SolarSystemEntity | undefined>(undefined);\n\n  useEffect(() => {\n    solarSystemApp.init(false);\n    solarSystemApp.onInitialising = handleInitialising;\n    solarSystemApp.onInitialised = handleInitialised;\n    solarSystemApp.onSelectPlanet = handleSelectPlanet;\n  }, [solarSystemApp]);\n\n  const handleInitialising = () => {\n    setIsLoading(true);\n  };\n\n  const handleInitialised = () => {\n    setIsLoading(false);\n  };\n\n  const handleSelectPlanet = (planet?: SolarSystemEntity) => {\n    setSelectedPlanet(planet);\n  };\n\n  return (\n    <>\n      <LoadingIndicator show={isLoading} />\n      <PlanetDataSheet planet={selectedPlanet}></PlanetDataSheet>\n    </>\n  );\n};\n","// https://www.imagineforest.com/blog/planet-name-generator/\nexport const planetNames = [\n  \"Acanthis\",\n  \"Achelous\",\n  \"Acheron\",\n  \"Achilles\",\n  \"Achilles\",\n  \"Achlys\",\n  \"Actaeon\",\n  \"Admetus\",\n  \"Adoni\",\n  \"Aeacus\",\n  \"Aëdon\",\n  \"Aeëtes\",\n  \"Aegisthus\",\n  \"Aegyptus\",\n  \"Aella\",\n  \"Aello\",\n  \"Aeneas\",\n  \"Aeolus\",\n  \"Aeternae\",\n  \"Aethon\",\n  \"Agamemnon\",\n  \"Aglaia\",\n  \"Agreus\",\n  \"Agriopas\",\n  \"Agrius\",\n  \"Ajax\",\n  \"Alcestis\",\n  \"Alcyone\",\n  \"Alcyoneus\",\n  \"Alecto\",\n  \"Alectryon\",\n  \"Alkyonides\",\n  \"Almops\",\n  \"Aloadae\",\n  \"Althaea\",\n  \"Amazon\",\n  \"Amazons\",\n  \"Ampelos\",\n  \"Amphion\",\n  \"Amphisbaena\",\n  \"Amphithemis\",\n  \"Amphitrite\",\n  \"Amphitryon\",\n  \"Amycus\",\n  \"Anchises\",\n  \"Andromache\",\n  \"Andromeda\",\n  \"Anteros\",\n  \"Antigone\",\n  \"Antinoüs\",\n  \"Antiphates\",\n  \"Aphrodit\",\n  \"Aphrodite\",\n  \"Apollo\",\n  \"Aquilo\",\n  \"Arachne\",\n  \"Arae\",\n  \"Ares\",\n  \"Arges\",\n  \"Argo\",\n  \"Argos\",\n  \"Argus\",\n  \"Argus\",\n  \"Ariadne\",\n  \"Arion\",\n  \"Arion\",\n  \"Artemi\",\n  \"Artemis\",\n  \"Asbolus\",\n  \"Ascalaphus\",\n  \"Asclepiu\",\n  \"Asclepius\",\n  \"Astarte\",\n  \"Asterius\",\n  \"Astraea\",\n  \"Atalanta\",\n  \"Atalanta\",\n  \"Athen\",\n  \"Athena\",\n  \"Athos\",\n  \"Atlas\",\n  \"Atreus\",\n  \"Atropos\",\n  \"Aurora\",\n  \"Auster\",\n  \"Autonous\",\n  \"Avernus\",\n  \"Bacchus\",\n  \"Balius\",\n  \"Bellerophon\",\n  \"Bellona\",\n  \"Bienor\",\n  \"Boreas\",\n  \"Briareus\",\n  \"Cadmus\",\n  \"Calliope\",\n  \"Calypso\",\n  \"Carduelis\",\n  \"Cassandra\",\n  \"Castor\",\n  \"Catoblepas\",\n  \"Celaeno\",\n  \"Centaur\",\n  \"Centauride\",\n  \"Centauromachy\",\n  \"Centaurs\",\n  \"Centaurus\",\n  \"Cephalus\",\n  \"Cepheus\",\n  \"Ceramici\",\n  \"Cerastes\",\n  \"Cerberus\",\n  \"Cercopes\",\n  \"Ceres\",\n  \"Cetus\",\n  \"Ceuthonymus\",\n  \"Ceyx\",\n  \"Chaos\",\n  \"Charon\",\n  \"Charybdis\",\n  \"Chimera\",\n  \"Chiron\",\n  \"Chiron\",\n  \"Chryseis\",\n  \"Chthonius\",\n  \"Circe\",\n  \"Clio\",\n  \"Clotho\",\n  \"Clytemnestra\",\n  \"Cornix\",\n  \"Coronis\",\n  \"Corvus\",\n  \"Crocotta\",\n  \"Crommyon\",\n  \"Cronu\",\n  \"Cronus\",\n  \"Cyclopes\",\n  \"Cycnus\",\n  \"Cyllarus\",\n  \"Cyprus\",\n  \"Daedalus\",\n  \"Daemons\",\n  \"Damarchus\",\n  \"Damysus\",\n  \"Danae\",\n  \"Danaïdes\",\n  \"Danaüs\",\n  \"Daphne\",\n  \"Demete\",\n  \"Dictys\",\n  \"Dido\",\n  \"Diomedes\",\n  \"Dione\",\n  \"Dionysu\",\n  \"Dionysus\",\n  \"Dioscuri\",\n  \"Dryad\",\n  \"Dryads\",\n  \"Echion\",\n  \"Echo\",\n  \"Eidolon\",\n  \"Elatus\",\n  \"Electra\",\n  \"Empousa\",\n  \"Empusa\",\n  \"Enceladus\",\n  \"Endymion\",\n  \"Enyo\",\n  \"Eo\",\n  \"Eos\",\n  \"Erato\",\n  \"Erebus\",\n  \"Eridanos\",\n  \"Erigone\",\n  \"Erinyes\",\n  \"Eris\",\n  \"Ero\",\n  \"Eros\",\n  \"Eteocles\",\n  \"Euphrosyne\",\n  \"Europa\",\n  \"Eurus\",\n  \"Euryale\",\n  \"Eurydice\",\n  \"Eurynomos\",\n  \"Eurystheus\",\n  \"Eurytion\",\n  \"Eurytus\",\n  \"Euterpe\",\n  \"Fates\",\n  \"Fauns\",\n  \"Faunus\",\n  \"Favonius\",\n  \"Flora\",\n  \"Fortuna\",\n  \"Furie\",\n  \"Furies\",\n  \"Gadflies\",\n  \"Gaea\",\n  \"Gaia\",\n  \"Galatea\",\n  \"Ganymede\",\n  \"Gegenees\",\n  \"Gello\",\n  \"Gerana\",\n  \"Geryon\",\n  \"giant\",\n  \"Giantess\",\n  \"Gigantes\",\n  \"Golden Fleece\",\n  \"Gorgons\",\n  \"Graces\",\n  \"Graeae\",\n  \"Graeae\",\n  \"Griffin\",\n  \"Hade\",\n  \"Hades\",\n  \"Hades\",\n  \"halcyons\",\n  \"Hamadryads\",\n  \"Harpies\",\n  \"Heb\",\n  \"Hecate\",\n  \"Hecate\",\n  \"Hecatonchires\",\n  \"Hector\",\n  \"Hecuba\",\n  \"Helen\",\n  \"Helio\",\n  \"Helios\",\n  \"Helle\",\n  \"Hellhound\",\n  \"Hephaestu\",\n  \"Hephaestus\",\n  \"Hera\",\n  \"Hera\",\n  \"Heracles\",\n  \"Hercules\",\n  \"Herme\",\n  \"Hero\",\n  \"heroes\",\n  \"Hesperus\",\n  \"Hesti\",\n  \"Hestia\",\n  \"Hieracosphinx\",\n  \"Hippalectryon\",\n  \"Hippocampus\",\n  \"Hippodamia\",\n  \"Hippolyte\",\n  \"Hippolytus\",\n  \"Hippomenes\",\n  \"Hoopoe\",\n  \"Hyacinthus\",\n  \"Hydra\",\n  \"Hylaeus\",\n  \"Hylonome\",\n  \"Hyperion\",\n  \"Hypno\",\n  \"Hypnos\",\n  \"Iapetus\",\n  \"Icarus\",\n  \"Ichthyocentaurs\",\n  \"Io\",\n  \"Iobates\",\n  \"Ionia\",\n  \"Iphigenia\",\n  \"Ipotane\",\n  \"Iris\",\n  \"Ismene\",\n  \"Ixion\",\n  \"Janus\",\n  \"Jocasta\",\n  \"Juno\",\n  \"Jupiter\",\n  \"Juventas\",\n  \"Keres\",\n  \"Kobaloi\",\n  \"Labour\",\n  \"Ladon\",\n  \"Laelaps\",\n  \"Laestrygonians\",\n  \"Laius\",\n  \"Lamia\",\n  \"Lamiai\",\n  \"Lamos\",\n  \"Laocoön\",\n  \"Lapiths\",\n  \"Lares\",\n  \"Lark\",\n  \"Latona\",\n  \"Lavinia\",\n  \"Leda\",\n  \"Lerna\",\n  \"Lernaean Hydra\",\n  \"Let\",\n  \"Lethe\",\n  \"Leto\",\n  \"Lycaon\",\n  \"Lykaia\",\n  \"Maera\",\n  \"Maia\",\n  \"Manes\",\n  \"Manticore\",\n  \"Marsyas\",\n  \"Medea\",\n  \"Medea\",\n  \"Medusa\",\n  \"Megaera\",\n  \"Meleager\",\n  \"Melpomene\",\n  \"Memnon\",\n  \"Menelaus\",\n  \"Menoetes\",\n  \"Menoetius\",\n  \"Mentor\",\n  \"Merope\",\n  \"Midas\",\n  \"Mimas\",\n  \"Minerva\",\n  \"Minos\",\n  \"Minotaur\",\n  \"Mnemosyne\",\n  \"Momus\",\n  \"Monocerata\",\n  \"Mormo\",\n  \"Mormolykeia\",\n  \"Morpheus\",\n  \"Mors\",\n  \"Muse\",\n  \"Muses\",\n  \"Myrmekes\",\n  \"Mysia\",\n  \"Naiads\",\n  \"Napaeae\",\n  \"Narcissus\",\n  \"Nemea\",\n  \"Nemesis\",\n  \"Neoptolemus\",\n  \"nereid\",\n  \"Nessus\",\n  \"Nestor\",\n  \"Nestor\",\n  \"Nike\",\n  \"Niobe\",\n  \"Nomios\",\n  \"Notus\",\n  \"Ny\",\n  \"Nyctimene\",\n  \"Nyctimus\",\n  \"Nymphs\",\n  \"Nyx\",\n  \"Oceanids\",\n  \"Oceanu\",\n  \"Oceanus\",\n  \"Ocypete\",\n  \"Odontotyrannos\",\n  \"Odysseu\",\n  \"Odysseus\",\n  \"Oedipus\",\n  \"Oenoe\",\n  \"Oenone\",\n  \"Onocentaur\",\n  \"Ophiotaurus\",\n  \"Ops\",\n  \"Orestes\",\n  \"Orion\",\n  \"Orpheus\",\n  \"Orthrus\",\n  \"Ouroboros\",\n  \"Pa\",\n  \"Pallas\",\n  \"Pan\",\n  \"Pan\",\n  \"Pandora\",\n  \"Panes\",\n  \"panthers\",\n  \"Parcae\",\n  \"Paris\",\n  \"Parrhasia\",\n  \"Pasiphaë\",\n  \"Patroclus\",\n  \"Pegasus\",\n  \"Pegasus\",\n  \"Pelias\",\n  \"Pelops\",\n  \"Penates\",\n  \"Penelope\",\n  \"Periboea\",\n  \"Perimedes\",\n  \"Persephon\",\n  \"Persephone \",\n  \"Perseus\",\n  \"Phaedra\",\n  \"Phaethon\",\n  \"Phaethon\",\n  \"Philoctetes\",\n  \"Philomela\",\n  \"Phineus\",\n  \"Phlegethon\",\n  \"Phoenix\",\n  \"Phólos\",\n  \"Pirithous\",\n  \"Pleiades\",\n  \"Plut\",\n  \"Pollux\",\n  \"Polybotes\",\n  \"Polyhymnia\",\n  \"Polymnia\",\n  \"Polynices\",\n  \"Polyphemus\",\n  \"Polyphemus\",\n  \"Polyxena\",\n  \"Pontus\",\n  \"Porphyrion\",\n  \"Poseido\",\n  \"Poseidon\",\n  \"Priam\",\n  \"Priapus\",\n  \"Procne\",\n  \"Procrustes\",\n  \"Prometheus\",\n  \"Proserpine\",\n  \"Proteus\",\n  \"Psyche\",\n  \"Pygmalion\",\n  \"Pyramus\",\n  \"Python\",\n  \"Quirinus\",\n  \"Rhadamanthus\",\n  \"Rhaecus\",\n  \"Rhe\",\n  \"Rhea\",\n  \"Romulus\",\n  \"Sarpedon\",\n  \"Saturn\",\n  \"Satyresses\",\n  \"Satyrs\",\n  \"Scylla\",\n  \"Selene\",\n  \"Semele\",\n  \"Sileni\",\n  \"Silenus\",\n  \"Silvanus\",\n  \"Siren\",\n  \"Sirens\",\n  \"Sisyphus\",\n  \"Sol\",\n  \"Somnus\",\n  \"Sphinx\",\n  \"Sterop\",\n  \"Stheno\",\n  \"Strix\",\n  \"Styx\",\n  \"Symplegades\",\n  \"Syrinx\",\n  \"Talos\",\n  \"Tantalus\",\n  \"Taras\",\n  \"Taraxippi\",\n  \"Tartarus\",\n  \"Telemachus\",\n  \"Tellus\",\n  \"Tereus\",\n  \"Terminus\",\n  \"Terpsichore\",\n  \"Thalia\",\n  \"Thanato\",\n  \"Thanatos\",\n  \"Thaumas\",\n  \"Themis\",\n  \"Theseus\",\n  \"Thisbe\",\n  \"Thoon\",\n  \"Thrace\",\n  \"Thyestes\",\n  \"Tiresias\",\n  \"Tisiphone\",\n  \"Titans\",\n  \"Tithonus\",\n  \"Tityos\",\n  \"Triton\",\n  \"Trojan\",\n  \"Turnus\",\n  \"Typhon\",\n  \"Ulysses\",\n  \"Urania\",\n  \"Uranus\",\n  \"Venus\",\n  \"Vesta\",\n  \"Virgil\",\n  \"Vulcan\",\n  \"Xanthus\",\n  \"Zephyrus\",\n  \"Zeu\",\n  \"Zeus\",\n];\n","import mt19937 from \"@stdlib/random-base-mt19937\";\n\nconst MAX = 4294967295;\n\nexport class Random {\n  public static getRandom(seed: number[]) {\n    var rand = mt19937.factory({\n      seed: seed,\n    });\n\n    return rand() / MAX;\n  }\n\n  public static getRandomInt(min: number, max: number, seed: number[]) {\n    return Math.floor(Random.getRandom(seed) * (max - min + 1) + min);\n  }\n\n  public static getRandomFloat(min: number, max: number, seed: number[]) {\n    return Random.getRandom(seed) * (max - min) + min;\n  }\n\n  public static coinToss(seed: number[]) {\n    return Random.getRandom(seed) <= 0.5;\n  }\n\n  public static getRandomFromArray(array: any[], seed: number[]) {\n    const index = this.getRandomInt(0, array.length - 1, seed);\n    return array[index];\n  }\n\n  /**\n   * Gets a random point of a sphere, evenly distributed over the sphere.\n   * The sphere is centered at (x0,y0,z0) with the passed in radius.\n   * The returned point is returned as a three element array [x,y,z].\n   *\n   * @return [x,y,z]\n   */\n  public static getRandomPointInSphere(radius: number, x0: number, y0: number, z0: number) {\n    if (!x0) {\n      x0 = 0;\n    }\n    if (!y0) {\n      y0 = 0;\n    }\n    if (!z0) {\n      z0 = 0;\n    }\n\n    var u = Math.random();\n    var v = Math.random();\n    var theta = 2 * Math.PI * u;\n    var phi = Math.acos(1 - 2 * v);\n    var x = x0 + radius * Math.sin(phi) * Math.cos(theta);\n    var y = y0 + radius * Math.sin(phi) * Math.sin(theta);\n    var z = z0 + radius * Math.cos(phi);\n\n    return [x, y, z];\n  }\n}\n","import { EntityType, SolarSystem, SolarSystemEntity } from \"../models/SolarSystem\";\nimport { planetNames } from \"./planetNames\";\nimport { Random } from \"./Random\";\n\n// some real values from our own solar system to work from\n// distance in km, speeds in km/h\nconst solarSystemValues = {\n  solRadius: 695508,\n\n  earthOrbitSpeed: 110000,\n\n  minPlanetRadius: 2440, // mercury\n  maxPlanetRadius: 69911, // jupiter\n\n  minPlanetOrbitRadius: 59223859, // mercury\n  maxPlanetOrbitRadius: 4498438348, // neptune\n\n  maxPlanetOrbitSpeed: 172331, //mercury\n\n  minMoonOrbitRadius: 384400, // luna\n  maxMoonOrbitRadius: 1882709, // callisto\n\n  maxMoonOrbitSpeed: 62400, // io\n\n  // todo: gas planets spin fast than solid ones, factor this in when\n  // more planet types added\n  minPlanetSpinSpeed: 6.52, // venus\n  maxPlanetSpinSpeed: 45583, //jupiter\n\n  minDistanceBetweenPlanets: 41400000, //earth->venus\n\n  // https://www.nasa.gov/image-feature/picturing-our-solar-systems-asteroid-belt\n  minAsteroidSize: 200, //10,\n  maxAsteroidSize: 530,\n\n  // our asteroid belt sits between mars and jupiter\n  // so use that as a basis for including an asteroid belt or not\n  marsToJupiterDistance: 550390000,\n};\n\nexport const seedIndexes = {\n  radius: 0,\n  terrainHeight: 1,\n  colour: 2,\n  noiseMap: 3,\n  orbitDirection: 4,\n  orbitSpeed: 5,\n  spinSpeed: 6,\n  numberOfPlanets: 7,\n  orbitRadius: 8,\n  orbitInclanation: 9,\n  spinDirection: 10,\n  orbitStartPosition: 11,\n  planetName: 12,\n  rotation: 13,\n  scale: 14,\n  itemCount: 15,\n};\n\nexport class SolarSystemGenerator {\n  private entityId = 0;\n  private seed: number;\n\n  private solarSystem: SolarSystem = {\n    stars: [],\n  };\n\n  constructor(seed: number) {\n    this.seed = seed;\n  }\n\n  private getNextId(): number {\n    this.entityId++;\n    return this.entityId;\n  }\n\n  public generate(starRadius: number = 695508): SolarSystem {\n    const stars: SolarSystemEntity[] = [\n      {\n        entityType: EntityType.Star,\n        id: this.getNextId(),\n        name: `Star ${this.entityId}`,\n        seed: [this.seed, 0],\n        position: [0, 0, 0],\n        radius: starRadius,\n        terrainHeight: 0,\n        satellites: [],\n        orbitEntityId: 0,\n        orbitRadius: 0,\n        orbitSpeed: 0,\n        orbitDirection: 0,\n        orbitInclanation: 0,\n        orbitStartPosition: 0,\n        spinSpeed: Random.getRandomFloat(0.0001, 0.0003, [...[this.seed, 0], seedIndexes.spinSpeed]),\n        spinDirection: Random.coinToss([...[this.seed, 0], seedIndexes.spinDirection]) ? 1 : -1,\n      },\n    ];\n\n    for (let starIndex = 0; starIndex < stars.length; starIndex++) {\n      const star = stars[starIndex];\n      const baseSeed = [this.seed, starIndex];\n\n      const numberOfPlanets = Random.getRandomInt(1, 9, [...baseSeed, seedIndexes.numberOfPlanets]);\n\n      // generate random planet orbit radiuses\n      const planetOrbitRadiuses = this.createPlanetOrbitRadiuses(numberOfPlanets, baseSeed);\n\n      for (let planetIndex = 0; planetIndex < numberOfPlanets; planetIndex++) {\n        const baseSeed = [this.seed, starIndex, planetIndex];\n\n        const planetRadius = Random.getRandomInt(\n          solarSystemValues.minPlanetRadius,\n          solarSystemValues.maxPlanetRadius * 2,\n          [...baseSeed, seedIndexes.radius]\n        );\n\n        const planet = this.createPlanet(\n          planetIndex,\n          baseSeed,\n          planetRadius,\n          numberOfPlanets,\n          planetOrbitRadiuses[planetIndex],\n          star\n        );\n\n        // create the moons for the planet\n        const numberOfMoons = Random.getRandomInt(1, 10, [...baseSeed, seedIndexes.numberOfPlanets]);\n\n        // generate random moon orbit radiuses\n        const moonOrbitRadiuses = new Array(numberOfMoons)\n          .fill(null)\n          .map((item, index) =>\n            Random.getRandomInt(solarSystemValues.minMoonOrbitRadius, solarSystemValues.maxMoonOrbitRadius, [\n              ...baseSeed,\n              seedIndexes.orbitRadius,\n              index,\n            ])\n          )\n          .sort((a, b) => a - b);\n\n        for (let moonIndex = 0; moonIndex < numberOfMoons; moonIndex++) {\n          const baseSeed = [this.seed, starIndex, planetIndex, moonIndex];\n\n          const moonRadius = Random.getRandomInt(planetRadius / 12, planetRadius / 3, [\n            ...baseSeed,\n            seedIndexes.radius,\n          ]);\n\n          const moon = this.createMoon(moonIndex, baseSeed, moonRadius, moonOrbitRadiuses[moonIndex], numberOfMoons);\n          planet.satellites.push(moon);\n        }\n        // Calculate orbit speeds based on distance from planet\n        for (const moon of planet.satellites) {\n          const distanceFromPlanet = moon.orbitRadius;\n          const furthestMoonOrbitRadius = planet.satellites[planet.satellites.length - 1].orbitRadius;\n          const ratio = 1.5 - distanceFromPlanet / furthestMoonOrbitRadius;\n          moon.orbitSpeed = ratio * solarSystemValues.maxMoonOrbitSpeed;\n        }\n\n        star.satellites.push(planet);\n\n        // if there's a big enough gap between planets, add an asteroid belt\n        if (planetIndex < numberOfPlanets - 1 && star.satellites.every((s) => s.entityType === EntityType.Planet)) {\n          const r1 = planetOrbitRadiuses[planetIndex];\n          const r2 = planetOrbitRadiuses[planetIndex + 1];\n          const numberOfAsteroids = Random.getRandomInt(500, 2000, [...baseSeed, planetIndex, seedIndexes.itemCount]);\n          if (r2 - r1 > solarSystemValues.marsToJupiterDistance) {\n            star.satellites.push({\n              entityType: EntityType.AsteroidBelt,\n              id: this.getNextId(),\n              name: \"\",\n              seed: [...baseSeed, planetIndex],\n              radius: solarSystemValues.minAsteroidSize,\n              maxRadius: solarSystemValues.maxAsteroidSize,\n              terrainHeight: 1,\n              satellites: [],\n              orbitEntityId: star.id,\n              orbitRadius: r1 + (r2 - r1) / 2,\n              orbitDirection: 1,\n              orbitSpeed: 1,\n              orbitInclanation: 0,\n              orbitStartPosition: 0,\n              spinSpeed: 0,\n              spinDirection: 1,\n              itemCount: numberOfAsteroids,\n            });\n          }\n        }\n      }\n\n      // Calculate orbit speeds based on distance from star\n      for (const planet of star.satellites) {\n        const distanceFromStar = planet.orbitRadius;\n        const furthestPlanetOrbitRadius = star.satellites[star.satellites.length - 1].orbitRadius;\n        const ratio = 1.5 - distanceFromStar / furthestPlanetOrbitRadius;\n        planet.positionInSystem = distanceFromStar / furthestPlanetOrbitRadius;\n        planet.orbitSpeed = ratio * solarSystemValues.maxPlanetOrbitSpeed;\n      }\n\n      this.solarSystem.stars.push(star);\n    }\n\n    return this.solarSystem;\n  }\n\n  private createPlanetOrbitRadiuses(numberOfPlanets: number, baseSeed: number[]) {\n    const planetOrbitRadiuses = new Array(numberOfPlanets)\n      .fill(null)\n      .map((item, index) =>\n        Random.getRandomInt(solarSystemValues.minPlanetOrbitRadius, solarSystemValues.maxPlanetOrbitRadius, [\n          ...baseSeed,\n          seedIndexes.orbitRadius,\n          index,\n        ])\n      )\n      .sort((a, b) => a - b);\n\n    // Ensure a min distance between planets\n    for (let i = 0; i < planetOrbitRadiuses.length - 1; i++) {\n      const po1 = planetOrbitRadiuses[i];\n      const po2 = planetOrbitRadiuses[i + 1];\n\n      const distanceBetween = po2 - po1;\n\n      if (distanceBetween < solarSystemValues.minDistanceBetweenPlanets) {\n        // if the distance is too small, push all outer planets away by the difference and carry on the loop\n        for (let index = i + 1; index < planetOrbitRadiuses.length; index++) {\n          planetOrbitRadiuses[index] += solarSystemValues.minDistanceBetweenPlanets - distanceBetween;\n        }\n      }\n    }\n\n    return planetOrbitRadiuses;\n  }\n\n  private createMoon(index: number, baseSeed: number[], radius: number, orbitRadius: number, numberOfMoons: number) {\n    const randomOrbitDirection = Random.coinToss([...baseSeed, seedIndexes.orbitDirection]) ? 1 : -1;\n\n    const randomSpinSpeed = Random.getRandomFloat(0.001, 0.005, [...baseSeed, seedIndexes.spinSpeed]);\n\n    const moon: SolarSystemEntity = {\n      entityType: EntityType.Moon,\n      id: this.getNextId(),\n      name: `Moon ${index + 1}`,\n      seed: baseSeed,\n      radius: radius,\n      terrainHeight: Random.getRandom([...baseSeed, seedIndexes.terrainHeight]),\n      orbitEntityId: -1,\n      orbitRadius: orbitRadius,\n      orbitDirection: randomOrbitDirection,\n      orbitSpeed: (numberOfMoons - index) / numberOfMoons,\n      orbitInclanation: Random.getRandomInt(0, 45, [...baseSeed, seedIndexes.orbitInclanation]),\n      orbitStartPosition: Random.getRandom([...baseSeed, seedIndexes.orbitStartPosition]),\n      spinSpeed: randomSpinSpeed,\n      spinDirection: Random.coinToss([...baseSeed, seedIndexes.spinDirection]) ? 1 : -1,\n      rgb: getRandomRgb([...baseSeed, seedIndexes.colour]),\n      satellites: [],\n    };\n\n    return moon;\n  }\n\n  private createPlanet(\n    index: number,\n    baseSeed: number[],\n    radius: number,\n    numberOfPlanets: number,\n    orbitRadius: number,\n    star: SolarSystemEntity\n  ) {\n    const randomOrbitDirection = Random.coinToss([...baseSeed, seedIndexes.orbitDirection]) ? 1 : -1;\n    const randomSpinSpeed = Random.getRandomFloat(0.002, 0.006, [...baseSeed, seedIndexes.spinSpeed]);\n    const planetName = Random.getRandomFromArray(planetNames, [...baseSeed, seedIndexes.planetName]);\n\n    // create the planet\n    const planet: SolarSystemEntity = {\n      entityType: EntityType.Planet,\n      id: this.getNextId(),\n      name: planetName,\n      seed: baseSeed,\n      radius: radius,\n      terrainHeight: 1,\n      orbitEntityId: star.id,\n      orbitRadius: orbitRadius,\n      orbitDirection: randomOrbitDirection,\n      orbitSpeed: (numberOfPlanets - index) / numberOfPlanets,\n      orbitInclanation: Random.getRandomInt(0, 15, [...baseSeed, seedIndexes.orbitInclanation]),\n      orbitStartPosition: Random.getRandom([...baseSeed, seedIndexes.orbitStartPosition]),\n      spinSpeed: randomSpinSpeed,\n      spinDirection: Random.coinToss([...baseSeed, seedIndexes.spinDirection]) ? 1 : -1,\n      satellites: [],\n    };\n\n    return planet;\n  }\n}\n\nconst getRandomRgb = (seed: number[]): [number, number, number] => {\n  return [\n    Random.getRandomFloat(0.6, 1, [...seed, 0]),\n    Random.getRandomFloat(0.6, 1, [...seed, 1]),\n    Random.getRandomFloat(0.6, 1, [...seed, 2]),\n  ];\n};\n","import SimplexNoise from \"simplex-noise\";\nimport { MathUtils } from \"three\";\n\nexport class NoiseMapGenerator {\n  private noiseGenerator: SimplexNoise;\n\n  constructor(seed?: number) {\n    this.noiseGenerator = new SimplexNoise(seed);\n  }\n\n  public generateNoiseMap(width: number, height: number): number[][] {\n    const map: number[][] = [];\n\n    for (let x = 0; x < width; x++) {\n      map[x] = [];\n      for (let y = 0; y < height; y++) {\n        // add noise at various frequencies\n        let noise = this.getMixedFrequencyNoise(\n          x,\n          y,\n          [0.01, 0.02, 0.04, 0.08, 0.16, 0.32, 0.64, 1.28]\n        );\n        noise = Math.pow(noise, 2.3);\n\n        map[x][y] = noise;\n      }\n    }\n\n    this.makeSeamlessVertically(map, height * 0.2);\n    this.makeSeamlessHorizontally(map, width * 0.05);\n\n    return map;\n  }\n\n  private getNoise(\n    x: number,\n    y: number,\n    frequency: number,\n    xOffset: number = 0,\n    yOffset: number = 0\n  ) {\n    const _x = frequency * x + xOffset;\n    const _y = frequency * y + yOffset;\n    const amplitude = 1 / frequency;\n\n    // get noise in the range 0-1\n    const n = this.noiseGenerator.noise2D(_x, _y) / 2 + 0.5;\n\n    let noise = amplitude * n;\n    return noise;\n  }\n\n  private getMixedFrequencyNoise(x: number, y: number, frequencies: number[]) {\n    let sumOfAmplitudes = 0;\n    const noise = frequencies.reduce(\n      (previous: number, frequency: number, index: number) => {\n        sumOfAmplitudes += 1 / frequency;\n\n        // add offsets so different frequencies (octaves)\n        // sample from a different part of the noise space\n        const xOffset = index * 10;\n        const yOffset = index * 100;\n        return previous + this.getNoise(x, y, frequency, xOffset, yOffset);\n      },\n      0\n    );\n    return noise / sumOfAmplitudes;\n  }\n\n  // ported from here:\n  // https://medium.com/nerd-for-tech/making-a-seamless-perlin-noise-in-c-4cfc12a90f93\n  private makeSeamlessHorizontally(noiseMap: number[][], stitchWidth: number) {\n    const width = noiseMap.length;\n    const height = noiseMap[0].length;\n\n    // iterate on the stitch band (on the left\n    // of the noise)\n    for (let x = 0; x < stitchWidth; x++) {\n      // get the transparency value from\n      // a linear gradient\n      const v = x / stitchWidth;\n\n      for (let y = 0; y < height; y++) {\n        // compute the \"mirrored x position\":\n        // the far left is copied on the right\n        // and the far right on the left\n        const o = ~~(width - stitchWidth + x);\n        // copy the value on the right of the noise\n        noiseMap[o][y] = MathUtils.lerp(\n          noiseMap[o][y],\n          noiseMap[~~(stitchWidth - x)][y],\n          v\n        );\n      }\n    }\n  }\n\n  // ported from here:\n  // https://medium.com/nerd-for-tech/making-a-seamless-perlin-noise-in-c-4cfc12a90f93\n  private makeSeamlessVertically(noiseMap: number[][], stitchHeight: number) {\n    const width = noiseMap.length;\n    const height = noiseMap[0].length;\n\n    // iterate through the stitch band (both\n    // top and bottom sides are treated\n    // simultaneously because its mirrored)\n    for (let y = 0; y < stitchHeight; y++) {\n      // number of neighbour pixels to\n      // consider for the average (= kernel size)\n      const k = Math.ceil(stitchHeight - y);\n      // go through the entire row\n      for (let x = 0; x < width; x++) {\n        // compute the sum of pixel values\n        // in the top and the bottom bands\n        let s1 = 0.0;\n        let s2 = 0.0;\n        let c = 0;\n        for (let o = x - k; o < x + k; o++) {\n          if (o < 0 || o >= width) {\n            continue;\n          }\n\n          s1 += noiseMap[o][y];\n          s2 += noiseMap[o][height - y - 1];\n          c++;\n        }\n        // compute the means and assign them to\n        // the pixels in the top and the bottom\n        // rows\n        noiseMap[x][y] = s1 / c;\n        noiseMap[x][height - y - 1] = s2 / c;\n      }\n    }\n  }\n}\n","import {\n  CanvasTexture,\n  Clock,\n  Color,\n  EquirectangularReflectionMapping,\n  Group,\n  Line,\n  LineBasicMaterial,\n  Material,\n  Mesh,\n  MeshBasicMaterial,\n  MeshPhongMaterial,\n  SphereBufferGeometry,\n  TextureLoader,\n  Vector3,\n  BufferGeometry,\n  BufferAttribute,\n  Texture,\n  MathUtils,\n  SpriteMaterial,\n  Sprite,\n  Camera,\n} from \"three\";\nimport { EntityParams } from \"../models/EntityParams\";\n\nimport { NoiseMapGenerator } from \"../utils/NoiseMapGenerator\";\n\ntype TerrainMaps = {\n  heightMap: CanvasRenderingContext2D;\n  map: CanvasRenderingContext2D;\n};\n\nexport abstract class Entity {\n  public entity: Group;\n  public params: EntityParams;\n  public radius: number;\n  public sphere!: Mesh;\n  public orbit!: Material;\n\n  protected textureWidth: number;\n  protected textureHeight: number;\n  protected abstract maxTerrainHeight: number;\n  protected material!: Material;\n  protected heightMapTexture!: CanvasTexture;\n  protected colourMapTexture!: CanvasTexture;\n\n  protected loader = new TextureLoader();\n  protected sphereGeometry!: SphereBufferGeometry;\n  protected orbitGeometry!: BufferGeometry;\n  protected texture!: Texture;\n\n  protected labelContext!: CanvasRenderingContext2D;\n  protected labelTexture!: Texture;\n  protected labelSprite!: Sprite;\n  protected labelScaleVector = new Vector3();\n  protected labelAspectRatio!: number;\n\n  constructor(radius: number, params: EntityParams) {\n    this.radius = radius;\n    this.params = params;\n\n    this.entity = new Group();\n\n    this.textureWidth = 512;\n    this.textureHeight = 256;\n  }\n\n  public async create() {\n    if (this.params.terrainHeight && this.params.terrainHeight > 0) {\n      const terrainMaps = this.generateTerrainMaps();\n\n      this.heightMapTexture = new CanvasTexture(terrainMaps.heightMap.canvas);\n      this.colourMapTexture = new CanvasTexture(terrainMaps.map.canvas);\n\n      this.heightMapTexture.mapping = EquirectangularReflectionMapping;\n      this.colourMapTexture.mapping = EquirectangularReflectionMapping;\n\n      const terrainHeight = Math.ceil(this.params.terrainHeight * this.maxTerrainHeight);\n\n      this.material = new MeshPhongMaterial({\n        bumpMap: this.heightMapTexture,\n        bumpScale: terrainHeight,\n        map: this.colourMapTexture,\n        displacementMap: this.heightMapTexture,\n        displacementScale: terrainHeight,\n        shininess: 0,\n        specular: 0x000000,\n      });\n    } else {\n      if (this.params.texturePath) {\n        this.texture = await this.loader.loadAsync(this.params.texturePath);\n        this.material = new MeshBasicMaterial({ map: this.texture, color: this.params.colour });\n      } else {\n        this.material = new MeshBasicMaterial({\n          color: this.params.colour,\n        });\n      }\n    }\n\n    this.sphereGeometry = new SphereBufferGeometry(this.radius, 64, 48);\n    this.sphere = new Mesh(this.sphereGeometry, this.material);\n\n    this.sphere.castShadow = !!this.params.castShadow;\n    this.sphere.receiveShadow = !!this.params.receiveShadow;\n\n    if (this.params.hasLabel) {\n      this.addLabel();\n    }\n\n    this.entity.add(this.sphere);\n\n    if (this.params.orbitEntity) {\n      const orbitEntityPos = this.params.orbitEntity.sphere.position;\n      const orbitRadius = this.params.orbitRadius;\n\n      // create an orbit cirlce and add it to the entity\n      const orbit = this.createOrbitCircle(orbitRadius);\n      this.entity.add(orbit);\n\n      // position the sphere at the edge of the orbit circle\n      this.sphere.position.set(orbitRadius, 0, 0);\n\n      // position the whole entity at the orbit entity position\n      this.entity.position.set(orbitEntityPos.x, orbitEntityPos.y, orbitEntityPos.z);\n\n      // set orbit inclanation/tilt\n      this.entity.rotation.x = MathUtils.degToRad(this.params.orbitInclanation);\n\n      // set initial orbit position\n      this.entity.rotation.y = MathUtils.degToRad(360 * this.params.orbitStartPosition);\n    }\n\n    return this;\n  }\n\n  public animate(clock: Clock, speed: number, camera: Camera, showLabels: boolean) {\n    clock.getElapsedTime();\n\n    if (this.params.orbitEntity) {\n      // (/60=mins /60=seconds /60=account for framerate)\n      const perSecond = this.params.orbitSpeed / 60 / 60 / 60;\n\n      const orbitSpeed = perSecond * speed;\n      const orbitDirection = this.params.orbitDirection;\n\n      // as our planet/moon is positioned at the edge of our orbit circle\n      // \"orbiting\" is simply a matter of rotating the whole entity :)\n      this.entity.rotation.y += orbitSpeed * orbitDirection;\n    }\n\n    if (this.params.spinSpeed) {\n      const perSecond = this.params.spinSpeed / 60 / 60 / 60;\n      this.sphere.rotation.y += perSecond * speed * this.params.spinDirection;\n    }\n\n    if (this.params.hasLabel) {\n      this.labelSprite.visible = showLabels;\n      if (showLabels) {\n        // keep the label the same size regardless of camera zoom\n        const scaleFactor = 24;\n        const scale = this.labelScaleVector.subVectors(this.sphere.position, camera.position).length() / scaleFactor;\n        this.labelSprite.scale.set(scale, scale * this.labelAspectRatio, 1);\n        this.labelSprite.position.y = this.radius;\n      }\n    }\n  }\n\n  public show() {\n    if (this.params.onShow) {\n      this.params.onShow(this.params.id);\n    }\n  }\n\n  protected abstract _dispose(): void;\n  public dispose() {\n    // geometries\n    this.sphereGeometry?.dispose();\n    this.orbitGeometry?.dispose();\n\n    // materials\n    this.orbit?.dispose();\n    this.material?.dispose();\n\n    // textures\n    this.heightMapTexture?.dispose();\n    this.colourMapTexture?.dispose();\n    this.texture?.dispose();\n    this.labelTexture?.dispose();\n\n    // call implemented dispose method\n    this._dispose();\n  }\n\n  protected generateTerrainMaps(): TerrainMaps {\n    const recordSize = 4;\n\n    const heightMapContext = this.getCanvasContext();\n    const heightMapImageData = heightMapContext.createImageData(this.textureWidth, this.textureHeight);\n    const heightMapData = heightMapImageData.data;\n\n    const colourMapContext = this.getCanvasContext();\n    const colourMapImageData = colourMapContext.createImageData(this.textureWidth, this.textureHeight);\n    const colourMapData = colourMapImageData.data;\n\n    const seed = [...this.params.seed, 99999].reduce((acc, cur) => (acc += cur));\n    const ng = new NoiseMapGenerator(seed);\n    const noiseMap = ng.generateNoiseMap(this.textureWidth, this.textureHeight);\n\n    for (let i = 0; i < heightMapData.length; i += recordSize) {\n      const x = (i / recordSize) % this.textureWidth;\n      const y = ~~(i / recordSize / this.textureWidth);\n\n      const noise = noiseMap[x][y];\n      const generatedColourValue = 255 * noise;\n\n      let colourValue = generatedColourValue;\n\n      // RGBA\n      const heightColour = [colourValue, colourValue, colourValue, 255];\n      for (let ci = 0; ci < heightColour.length; ci++) {\n        heightMapData[i + ci] = heightColour[ci];\n      }\n\n      let mapColour = this.getMapColour(colourValue, y);\n\n      for (let ci = 0; ci < mapColour.length; ci++) {\n        colourMapData[i + ci] = mapColour[ci];\n      }\n    }\n\n    heightMapContext.putImageData(heightMapImageData, 0, 0);\n    colourMapContext.putImageData(colourMapImageData, 0, 0);\n\n    return {\n      heightMap: heightMapContext,\n      map: colourMapContext,\n    };\n  }\n\n  protected abstract getMapColour(height: number, y: number): number[];\n\n  protected getRangeColour(level: { min: number; max: number; dark: number[]; light: number[] }, height: number) {\n    return this.lerpColour(level.dark, level.light, (height - level.min) / (level.max - level.min));\n  }\n\n  protected lerpColour(col1: number[], col2: number[], ratio: number) {\n    const c = this.convertToColor(col1).lerp(this.convertToColor(col2), ratio);\n    return [...c.toArray(), 255];\n  }\n\n  protected convertToColor(colour: number[]) {\n    return new Color().setRGB(colour[0], colour[1], colour[2]);\n  }\n\n  protected getCanvasContext() {\n    const ctx = document.createElement(\"canvas\").getContext(\"2d\") as CanvasRenderingContext2D;\n    ctx.canvas.width = this.textureWidth;\n    ctx.canvas.height = this.textureHeight;\n    ctx.fillStyle = \"#fff\";\n    ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n    return ctx;\n  }\n\n  private createOrbitCircle(radius: number) {\n    var segmentCount = 128;\n    this.orbitGeometry = new BufferGeometry();\n    const verts = [];\n    this.orbit = new LineBasicMaterial({ color: 0x666666, opacity: 1, transparent: false });\n\n    for (var i = 0; i <= segmentCount; i++) {\n      var theta = (i / segmentCount) * Math.PI * 2;\n      verts.push(Math.cos(theta) * radius, 0, Math.sin(theta) * radius);\n    }\n    const vertices = new Float32Array(verts);\n    this.orbitGeometry.setAttribute(\"position\", new BufferAttribute(vertices, 3));\n    return new Line(this.orbitGeometry, this.orbit);\n  }\n\n  protected addLabel() {\n    this.labelContext = document.createElement(\"canvas\").getContext(\"2d\") as CanvasRenderingContext2D;\n\n    const fontSize = 44;\n    this.labelContext.canvas.width = 384;\n    this.labelContext.canvas.height = 384;\n\n    this.labelContext.font = `${fontSize}pt 'Lucida Grande', sans-serif`;\n\n    this.labelAspectRatio = this.labelContext.canvas.height / this.labelContext.canvas.width;\n\n    this.labelContext.fillStyle = \"white\";\n    this.labelContext.textAlign = \"center\";\n    this.labelContext.fillText(this.params.name, this.labelContext.canvas.width / 2, fontSize + 1);\n\n    this.labelTexture = new Texture(this.labelContext.canvas);\n    this.labelTexture.needsUpdate = true;\n    const spriteMaterial = new SpriteMaterial({\n      map: this.labelTexture,\n      transparent: true,\n    });\n    this.labelSprite = new Sprite(spriteMaterial);\n\n    this.sphere.add(this.labelSprite);\n  }\n}\n","import { Entity } from \"./Entity\";\n\nexport class Moon extends Entity {\n  protected maxTerrainHeight = 5;\n\n  protected _dispose(): void {}\n\n  protected getMapColour(height: number, y: number): number[] {\n    const ratio = height / 128;\n\n    const { r, g, b } = this.params.colour!;\n\n    const rgba = [Math.floor(r * 255), Math.floor(g * 255), Math.floor(b * 255), 255];\n\n    return [rgba[0] * ratio, rgba[1] * ratio, rgba[2] * ratio, rgba[3]];\n  }\n}\n","import { Random } from \"../utils/Random\";\nimport { Entity } from \"./Entity\";\n\nexport class ClassM extends Entity {\n  protected maxTerrainHeight = this.radius / 16;\n\n  protected _dispose(): void {}\n\n  private colours = {\n    oceanDark: this.getRandomColour(0),\n    oceanLight: this.getRandomColour(1),\n    beachDark: this.getRandomColour(2),\n    beachLight: this.getRandomColour(3),\n    forestDark: this.getRandomColour(4),\n    forestLight: this.getRandomColour(5),\n    jungleDark: this.getRandomColour(6),\n    jungleLight: this.getRandomColour(7),\n    savannahDark: this.getRandomColour(8),\n    savannahLight: this.getRandomColour(9),\n    desertDark: this.getRandomColour(10),\n    desertLight: this.getRandomColour(11),\n    snowDark: this.getRandomColour(12),\n    snowLight: this.getRandomColour(13),\n  };\n\n  protected getMapColour(height: number, y: number) {\n    const colour = this.getColourForHeight(height);\n    return colour;\n  }\n\n  private getColourForHeight(height: number) {\n    const levels = [\n      // sea\n      {\n        min: 0,\n        max: 60,\n        dark: this.colours.oceanDark,\n        light: this.colours.oceanLight,\n      },\n      // beach\n      {\n        min: 60,\n        max: 70,\n        dark: this.colours.oceanLight,\n        light: this.colours.beachLight,\n      },\n      // forest\n      {\n        min: 70,\n        max: 110,\n        dark: this.colours.forestDark,\n        light: this.colours.forestLight,\n      },\n      // jungle\n      {\n        min: 110,\n        max: 120,\n        dark: this.colours.jungleDark,\n        light: this.colours.jungleLight,\n      },\n      // savannah\n      {\n        min: 120,\n        max: 140,\n        dark: this.colours.savannahDark,\n        light: this.colours.savannahLight,\n      },\n      // desert\n      {\n        min: 120,\n        max: 150,\n        dark: this.colours.desertDark,\n        light: this.colours.desertLight,\n      },\n    ];\n\n    for (const level of levels) {\n      if (height < level.max) {\n        return this.getRangeColour(level, height);\n      }\n    }\n\n    return this.colours.snowLight;\n  }\n\n  private getRandomColour(colIndex: number) {\n    const seed = [...this.params.seed, colIndex];\n\n    const min = 0.2;\n    return [\n      255 * Random.getRandomFloat(min, 1, [...seed, 0]),\n      255 * Random.getRandomFloat(min, 1, [...seed, 1]),\n      255 * Random.getRandomFloat(min, 1, [...seed, 2]),\n      255,\n    ];\n  }\n}\n","import { EntityParams } from \"../models/EntityParams\";\nimport { Entity } from \"./Entity\";\n\nexport class Star extends Entity {\n  protected maxTerrainHeight = 0;\n\n  constructor(radius: number, params: EntityParams) {\n    super(radius, params);\n\n    this.params.terrainHeight = 0;\n    this.params.texturePath = \"assets/sun.jpg\";\n  }\n\n  protected _dispose(): void {}\n\n  protected getMapColour(height: number, y: number): number[] {\n    const { r, g, b } = this.params.colour!;\n    const rgba = [Math.floor(r * 255), Math.floor(g * 255), Math.floor(b * 255), 255];\n    return [rgba[0], rgba[1], rgba[2], rgba[3]];\n  }\n}\n","import { Entity } from \"./Entity\";\n\nconst colours = {\n  oceanDark: [0, 24, 168, 255],\n  oceanLight: [0, 105, 148, 255],\n  beachDark: [140, 129, 95, 255],\n  beachLight: [221, 202, 146, 255],\n  forestDark: [0, 66, 37, 255],\n  forestLight: [0, 127, 72, 255],\n  jungleDark: [48, 102, 79, 255],\n  jungleLight: [57, 122, 94, 255],\n  savannahDark: [136, 155, 105, 255],\n  savannahLight: [165, 189, 126, 255],\n  desertDark: [175, 175, 144, 255],\n  desertLight: [198, 198, 167, 255],\n  snowDark: [200, 200, 200, 255],\n  snowLight: [255, 255, 255, 255],\n};\n\nexport class Earth extends Entity {\n  protected maxTerrainHeight = this.radius / 16;\n\n  protected _dispose(): void {}\n\n  protected getMapColour(height: number, y: number) {\n    const colour = this.getColourForHeight(height);\n\n    // if (y > this.textureHeight * 0.9) {\n    //   return this.lerpColour(colour, colours.snow, y / this.textureHeight);\n    // }\n\n    return colour;\n  }\n\n  private getColourForHeight(height: number) {\n    const levels = [\n      // sea\n      {\n        min: 0,\n        max: 60,\n        dark: colours.oceanDark,\n        light: colours.oceanLight,\n      },\n      // beach\n      {\n        min: 60,\n        max: 70,\n        dark: colours.oceanLight,\n        light: colours.beachLight,\n      },\n      // forest\n      {\n        min: 70,\n        max: 110,\n        dark: colours.forestDark,\n        light: colours.forestLight,\n      },\n      // jungle\n      {\n        min: 110,\n        max: 120,\n        dark: colours.jungleDark,\n        light: colours.jungleLight,\n      },\n      // savannah\n      {\n        min: 120,\n        max: 140,\n        dark: colours.savannahDark,\n        light: colours.savannahLight,\n      },\n      // desert\n      {\n        min: 120,\n        max: 150,\n        dark: colours.desertDark,\n        light: colours.desertLight,\n      },\n    ];\n\n    for (const level of levels) {\n      if (height < level.max) {\n        return this.getRangeColour(level, height);\n      }\n    }\n\n    return colours.snowLight;\n  }\n}\n","import {\n  CanvasTexture,\n  EquirectangularReflectionMapping,\n  MeshPhongMaterial,\n  MeshBasicMaterial,\n  SphereBufferGeometry,\n  MathUtils,\n  InstancedMesh,\n  Matrix4,\n  Euler,\n  Quaternion,\n  Vector3,\n  BufferAttribute,\n  BufferGeometry,\n  Line,\n  LineBasicMaterial,\n} from \"three\";\nimport { Random } from \"../utils/Random\";\nimport { seedIndexes } from \"../utils/SolarSystemGenerator\";\nimport { Entity } from \"./Entity\";\n\nexport class AsteroidBelt extends Entity {\n  protected maxTerrainHeight = this.radius < 10 ? 48 : this.radius / 16;\n\n  protected _dispose(): void {}\n\n  public async create() {\n    if (this.params.terrainHeight && this.params.terrainHeight > 0) {\n      const terrainMaps = this.generateTerrainMaps();\n\n      this.heightMapTexture = new CanvasTexture(terrainMaps.heightMap.canvas);\n      this.colourMapTexture = new CanvasTexture(terrainMaps.map.canvas);\n\n      this.heightMapTexture.mapping = EquirectangularReflectionMapping;\n      this.colourMapTexture.mapping = EquirectangularReflectionMapping;\n\n      const terrainHeight = Math.ceil(this.params.terrainHeight * this.maxTerrainHeight);\n\n      this.material = new MeshPhongMaterial({\n        bumpMap: this.heightMapTexture,\n        bumpScale: terrainHeight,\n        map: this.colourMapTexture,\n        displacementMap: this.heightMapTexture,\n        displacementScale: terrainHeight,\n        // shininess: 0,\n        // specular: 0x000000,\n      });\n    } else {\n      if (this.params.texturePath) {\n        this.texture = await this.loader.loadAsync(this.params.texturePath);\n        this.material = new MeshBasicMaterial({ map: this.texture, color: this.params.colour });\n      } else {\n        this.material = new MeshBasicMaterial({\n          color: this.params.colour,\n        });\n      }\n    }\n\n    const radius = Random.getRandomFloat(this.radius, Number(this.params.maxRadius), [\n      ...this.params.seed,\n      seedIndexes.radius,\n    ]);\n    const minScale = this.radius / radius;\n    const maxScale = Number(this.params.maxRadius) / radius;\n\n    this.sphereGeometry = new SphereBufferGeometry(radius, 64, 48);\n\n    const count = Number(this.params.itemCount);\n\n    this.sphere = new InstancedMesh(this.sphereGeometry, this.material, count);\n    const mesh = this.sphere as InstancedMesh;\n\n    const position = new Vector3();\n    const rotation = new Euler();\n    const quaternion = new Quaternion();\n    const scale = new Vector3();\n    const matrix = new Matrix4();\n\n    for (let i = 0; i <= count; i++) {\n      const theta = (i / count) * Math.PI * 2;\n\n      const mod = Random.getRandom([...this.params.seed, seedIndexes.radius, i]);\n      const cos = Math.cos(theta) * this.params.orbitRadius;\n      const sin = Math.sin(theta) * this.params.orbitRadius;\n      const randomDirection = Random.coinToss([...this.params.seed, seedIndexes.orbitDirection, i]) ? 1 : -1;\n      position.x = cos + cos * (mod % 0.2);\n      position.y = this.radius * this.radius * (mod % 0.5) * randomDirection;\n      position.z = sin + sin * (mod % 0.2);\n\n      rotation.x = Random.getRandom([...this.params.seed, seedIndexes.rotation, i, 1]) * 2 * Math.PI;\n      rotation.y = Random.getRandom([...this.params.seed, seedIndexes.rotation, i, 2]) * 2 * Math.PI;\n      rotation.z = Random.getRandom([...this.params.seed, seedIndexes.rotation, i, 3]) * 2 * Math.PI;\n\n      quaternion.setFromEuler(rotation);\n\n      const scaleAmount = 0.5 * Random.getRandomFloat(minScale, maxScale, [...this.params.seed, seedIndexes.scale, i]);\n      scale.set(scaleAmount, scaleAmount, scaleAmount);\n\n      matrix.compose(position, quaternion, scale);\n\n      mesh.setMatrixAt(i, matrix);\n    }\n\n    this.sphere.castShadow = !!this.params.castShadow;\n    this.sphere.receiveShadow = !!this.params.receiveShadow;\n\n    if (this.params.hasLabel) {\n      this.addLabel();\n    }\n\n    // mesh.instanceMatrix.setUsage(DynamicDrawUsage);\n    this.entity.add(mesh);\n\n    if (this.params.orbitEntity) {\n      const orbitEntityPos = this.params.orbitEntity.sphere.position;\n      // const orbitRadius = this.params.orbitRadius;\n\n      // // create an orbit cirlce and add it to the entity\n      // const orbit = this._createOrbitCircle(orbitRadius);\n      // this.entity.add(orbit);\n\n      // const orbit2 = this._createOrbitCircle(orbitRadius + orbitRadius * 0.2);\n      // this.entity.add(orbit2);\n\n      // position the whole entity at the orbit entity position\n      this.entity.position.set(orbitEntityPos.x, orbitEntityPos.y, orbitEntityPos.z);\n\n      // set orbit inclanation/tilt\n      this.entity.rotation.x = MathUtils.degToRad(this.params.orbitInclanation);\n\n      // set initial orbit position\n      this.entity.rotation.y = MathUtils.degToRad(360 * this.params.orbitStartPosition);\n    }\n\n    this.params.orbitSpeed *= 0.1;\n\n    return this;\n  }\n\n  protected getMapColour(height: number, y: number): number[] {\n    const ratio = height / 128;\n\n    const { r, g, b } = this.params.colour!;\n\n    const rgba = [Math.floor(r * 255), Math.floor(g * 255), Math.floor(b * 255), 255];\n\n    return [rgba[0] * ratio, rgba[1] * ratio, rgba[2] * ratio, rgba[3]];\n  }\n\n  // private _createOrbitCircle(radius: number) {\n  //   var segmentCount = 128;\n  //   this.orbitGeometry = new BufferGeometry();\n  //   const verts = [];\n  //   this.orbit = new LineBasicMaterial({ color: 0xff0000, opacity: 1, transparent: false });\n\n  //   for (var i = 0; i <= segmentCount; i++) {\n  //     var theta = (i / segmentCount) * Math.PI * 2;\n  //     verts.push(Math.cos(theta) * radius, 0, Math.sin(theta) * radius);\n  //   }\n  //   const vertices = new Float32Array(verts);\n  //   this.orbitGeometry.setAttribute(\"position\", new BufferAttribute(vertices, 3));\n  //   return new Line(this.orbitGeometry, this.orbit);\n  // }\n}\n","import {\n  AmbientLight,\n  // AxesHelper,\n  Camera,\n  Clock,\n  Color,\n  CubeTextureLoader,\n  MathUtils,\n  PerspectiveCamera,\n  PointLight,\n  Scene,\n  Texture,\n  Vector3,\n  WebGLRenderer,\n} from \"three\";\nimport { Easing, Tween, update as tweenUpdate } from \"@tweenjs/tween.js\";\nimport cloneDeep from \"lodash/cloneDeep\";\n\nimport { Entity } from \"./entities/Entity\";\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\nimport Stats from \"three/examples/jsm/libs/stats.module\";\nimport { GUI } from \"three/examples/jsm/libs/dat.gui.module\";\n\nimport { SolarSystemGenerator } from \"./utils/SolarSystemGenerator\";\n\nimport { Moon } from \"./entities/Moon\";\nimport { ClassM } from \"./entities/ClassM\";\nimport { Star } from \"./entities/Star\";\nimport { Earth } from \"./entities/Earth\";\nimport { EntityType, SolarSystem, SolarSystemEntity } from \"./models/SolarSystem\";\nimport { AsteroidBelt } from \"./entities/AsteroidBelt\";\nimport { EntityParams } from \"./models/EntityParams\";\n\nconst sunColour = 0xf7e096;\nconst animationDuration = 4000;\n\nexport class SolarSystemApp {\n  private solarSystem!: SolarSystem;\n\n  private isRunning = false;\n  private scene!: Scene;\n  private camera!: Camera;\n  private clock = new Clock();\n  private bodies: Entity[] = [];\n  private renderer!: WebGLRenderer;\n  private orbitControls!: OrbitControls;\n  private stats!: Stats;\n  private showPlanetId!: number;\n  private cameraInitialPosition!: [number, number, number];\n  private cameraLookAtTarget = new Vector3(0, 0, 0);\n  private cameraPositionVector = new Vector3();\n  private spaceTexture!: Texture;\n  private gui!: GUI;\n  private guiViewActionsFolder!: GUI;\n  private guiPlanetsFolder!: GUI;\n  private planetPositionVector = new Vector3();\n\n  private ambientLight!: AmbientLight;\n  private pointLight!: PointLight;\n\n  private cameraReachedTarget!: boolean;\n\n  // events\n  public onInitialising!: () => void;\n  public onInitialised!: () => void;\n  public onSelectPlanet!: (planet?: SolarSystemEntity) => void;\n\n  private options = {\n    seed: 982174,\n    simulationSpeed: 3,\n    showOrbits: true,\n    followPlanetName: \"Star 1\",\n    trueScale: false,\n    showPlanetLabels: false,\n    showAsteroidBelts: true,\n    showStats: true,\n  };\n\n  private buttonHandlers = {\n    resetView: () => {\n      this.resetView();\n    },\n    newSeed: () => {\n      this.options.seed = MathUtils.randInt(100000, 999999);\n      this.init();\n    },\n    changeSeed: () => {\n      this.init();\n    },\n  };\n\n  constructor() {\n    this.solarSystem = new SolarSystemGenerator(this.options.seed).generate();\n\n    this.scene = new Scene();\n    this.scene.background = new Color().setHex(0x000000);\n\n    const loader = new CubeTextureLoader();\n    this.spaceTexture = loader.load([\n      \"assets/kurt/space_ft.png\",\n      \"assets/kurt/space_bk.png\",\n      \"assets/kurt/space_up.png\",\n      \"assets/kurt/space_dn.png\",\n      \"assets/kurt/space_rt.png\",\n      \"assets/kurt/space_lf.png\",\n    ]);\n    this.scene.background = this.spaceTexture;\n\n    // Camera\n    this.camera = new Camera();\n    this.camera = new PerspectiveCamera(25, window.innerWidth / window.innerHeight, 50, 1e10);\n    this.cameraInitialPosition = [0, this.solarSystem.stars[0].radius * 6, this.solarSystem.stars[0].radius * 32];\n    this.camera.position.set(...this.cameraInitialPosition);\n\n    this.camera.lookAt(this.cameraLookAtTarget);\n\n    // Renderer\n    this.renderer = new WebGLRenderer({\n      powerPreference: \"high-performance\",\n      antialias: true,\n    });\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\n    this.renderer.setPixelRatio(window.devicePixelRatio);\n    this.renderer.shadowMap.enabled = true;\n    document.body.appendChild(this.renderer.domElement);\n\n    // Controls\n    this.orbitControls = new OrbitControls(this.camera, this.renderer.domElement);\n    this.orbitControls.enableDamping = true;\n    this.orbitControls.update();\n\n    // Stats\n    this.stats = new (Stats as any)();\n    document.body.appendChild(this.stats.dom);\n\n    // UI\n    this.gui = new GUI();\n    this.gui.width = 300;\n\n    const newSeedButton = this.gui.add(this.buttonHandlers, \"newSeed\").name(\"Generate new system\");\n    if (newSeedButton.domElement.parentElement) {\n      newSeedButton.domElement.parentElement.id = \"new-seed-button\";\n    }\n\n    this.gui.add(this.options, \"seed\").name(\"Seed\").onFinishChange(this.buttonHandlers.changeSeed);\n    this.gui.add(this.options, \"simulationSpeed\", 0, 20, 0.1).name(\"Simulation Speed\");\n  }\n\n  public init = (regenSolarSystem = true) => {\n    this.showPlanetId = -1;\n\n    if (this.onInitialising) {\n      this.onInitialising();\n    }\n\n    this.gui.updateDisplay();\n    this.clearScene();\n\n    if (regenSolarSystem) {\n      this.solarSystem = new SolarSystemGenerator(this.options.seed).generate();\n    }\n\n    // default to showing labels when in true scale (and vice-versa)\n    this.options.showPlanetLabels = this.options.trueScale;\n\n    this._init().then(() => {\n      this.resetView();\n      this.animate();\n      if (this.onInitialised) {\n        this.onInitialised();\n      }\n    });\n  };\n\n  private _init = async () => {\n    this.showPlanetId = -1;\n\n    // var axesHelper = new AxesHelper(5000);\n    // this.scene.add(axesHelper);\n\n    // Lighting\n    this.pointLight = new PointLight(sunColour, 1);\n\n    let ambientLightIntensity = 0.15;\n    if (this.options.trueScale) {\n      // star\n      this.pointLight.power = 1.05e14; // lumens\n      this.renderer.physicallyCorrectLights = true;\n      this.pointLight.decay = 2;\n      // needs slightly more ambient light because planets aren't illuminated as much\n      ambientLightIntensity = 0.3;\n    } else {\n      this.pointLight.decay = 1;\n      this.renderer.physicallyCorrectLights = false;\n    }\n    this.pointLight.position.set(0, 0, 0);\n    this.scene.add(this.pointLight);\n\n    this.ambientLight = new AmbientLight(0xffffff, ambientLightIntensity);\n    this.scene.add(this.ambientLight);\n\n    if (this.options.trueScale) {\n      await this.renderRealisticSolarSystem();\n      this.camera.position.set(...this.cameraInitialPosition);\n    } else {\n      await this.renderSolarSystem();\n      this.camera.position.set(...this.cameraInitialPosition).divideScalar(500);\n    }\n\n    const planets = this.bodies.filter((b) => b.params.entityType === EntityType.Planet);\n    const star = this.bodies.filter((b) => b.params.entityType === EntityType.Star)[0];\n\n    this.guiViewActionsFolder = this.gui.addFolder(\"View Options\");\n    this.guiViewActionsFolder.open();\n\n    this.guiViewActionsFolder\n      .add(this.options, \"followPlanetName\", [star.params.name, ...planets.map((p) => p.params.name)])\n      .name(\"Centre of View\")\n      .onChange(this.onFollowPlanetNameChange);\n\n    this.guiViewActionsFolder.add(this.options, \"trueScale\").name(\"True Scale\").onChange(this.init);\n    this.guiViewActionsFolder.add(this.options, \"showOrbits\").name(\"Orbits\").onChange(this.toggleOrbits);\n    this.guiViewActionsFolder.add(this.options, \"showPlanetLabels\").name(\"Labels\");\n    this.guiViewActionsFolder\n      .add(this.options, \"showAsteroidBelts\")\n      .name(\"Asteroid Belt\")\n      .onChange(this.toggleAsteroidBelts);\n    this.guiViewActionsFolder.add(this.options, \"showStats\").name(\"Stats\").onChange(this.handleShowStatsChange);\n\n    this.guiPlanetsFolder = this.gui.addFolder(\"Planets\");\n    this.guiPlanetsFolder.open();\n    this.guiPlanetsFolder.add(this.buttonHandlers, \"resetView\").name(\"Reset View\");\n    for (let index = 0; index < planets.length; index++) {\n      const planet = planets[index];\n      this.guiPlanetsFolder.add(planet, \"show\").name(`#${index + 1}: ${planet.params.name}`);\n    }\n\n    this.isRunning = true;\n  };\n\n  public animate = () => {\n    if (!this.isRunning) {\n      return;\n    }\n    requestAnimationFrame(this.animate);\n\n    this.bodies.forEach((body) => {\n      body.animate(\n        this.clock,\n        this.options.simulationSpeed / 2,\n        this.camera,\n        this.options.showPlanetLabels && this.showPlanetId !== body.params.id\n      );\n    });\n\n    if (this.options.showStats) {\n      this.stats.update();\n    }\n\n    if (this.showPlanetId > -1) {\n      const planet = this.bodies.find((b) => b.params.id === this.showPlanetId);\n\n      if (planet && this.cameraReachedTarget) {\n        planet.sphere.getWorldPosition(this.planetPositionVector);\n        const { x, y, z } = this.planetPositionVector;\n        this.camera.position.set(x + planet.radius * 5, y, z + planet.radius * 10);\n        this.cameraLookAtTarget.set(x, y, z);\n        this.camera.lookAt(this.cameraLookAtTarget);\n      }\n    } else {\n      if (this.options.followPlanetName !== \"Star 1\") {\n        const planet = this.bodies.find((b) => b.params.name === this.options.followPlanetName);\n        if (planet) {\n          planet.sphere.getWorldPosition(this.planetPositionVector);\n          const { x, y, z } = this.planetPositionVector;\n          this.orbitControls.target.set(x, y, z);\n          this.orbitControls.update();\n        }\n      }\n    }\n\n    tweenUpdate();\n    this.renderer.render(this.scene, this.camera);\n  };\n\n  private clearScene = () => {\n    this.isRunning = false;\n\n    try {\n      this.gui.removeFolder(this.guiViewActionsFolder);\n      this.gui.removeFolder(this.guiPlanetsFolder);\n      this.guiViewActionsFolder.destroy();\n    } catch (error) {}\n\n    this.ambientLight?.dispose();\n    this.pointLight?.dispose();\n\n    for (const body of this.bodies) {\n      body.dispose();\n    }\n    this.bodies = [];\n    this.scene.clear();\n\n    this.renderer.render(this.scene, this.camera);\n  };\n\n  private resetView = () => {\n    this.showPlanetId = -1;\n\n    if (this.options.trueScale) {\n      this.cameraPositionVector.set(...this.cameraInitialPosition);\n    } else {\n      this.cameraPositionVector.set(...this.cameraInitialPosition).divideScalar(500);\n    }\n\n    // animate camera position\n    new Tween(this.camera.position)\n      .to(this.cameraPositionVector)\n      .duration(animationDuration)\n      .easing(Easing.Quintic.InOut)\n      .start();\n\n    //animate camera lookAt\n    new Tween(this.cameraLookAtTarget)\n      .to(new Vector3(0, 0, 0))\n      .duration(animationDuration)\n      .easing(Easing.Quintic.InOut)\n      .onUpdate(() => this.camera.lookAt(this.cameraLookAtTarget))\n      .start();\n\n    if (this.onSelectPlanet) {\n      this.onSelectPlanet(undefined);\n    }\n    this.orbitControls.update();\n  };\n\n  private handleShowStatsChange = () => {\n    if (this.options.showStats) {\n      this.stats.dom.style.display = \"initial\";\n    } else {\n      this.stats.dom.style.display = \"none\";\n    }\n  };\n\n  private handleShowPlanet = (id: number) => {\n    this.showPlanetId = id;\n\n    const planet = this.bodies.find((b) => b.params.id === this.showPlanetId);\n    if (planet) {\n      planet.sphere.getWorldPosition(this.planetPositionVector);\n      const { x, y, z } = this.planetPositionVector;\n      const target = { x: x + planet.radius * 5, y, z: z + planet.radius * 10 };\n\n      this.cameraReachedTarget = false;\n\n      // animate camera position\n      const tween = new Tween(this.camera.position)\n        .to(target)\n        .duration(animationDuration)\n        .easing(Easing.Quintic.InOut)\n        .start()\n        .onUpdate(() => {\n          planet.sphere.getWorldPosition(this.planetPositionVector);\n          const { x, y, z } = this.planetPositionVector;\n          const target = { x: x + planet.radius * 5, y, z: z + planet.radius * 10 };\n          tween.to(target);\n        })\n        .onComplete(() => {\n          this.cameraReachedTarget = true;\n        });\n\n      //animate camera lookAt\n      new Tween(this.cameraLookAtTarget)\n        .to(this.planetPositionVector)\n        .duration(animationDuration)\n        .easing(Easing.Cubic.Out)\n        .onUpdate(() => this.camera.lookAt(this.cameraLookAtTarget))\n        .start();\n    }\n\n    if (this.onSelectPlanet) {\n      const planet = this.solarSystem.stars[0].satellites.find((p) => p.id === id) as SolarSystemEntity;\n      this.onSelectPlanet(planet);\n    }\n  };\n\n  private toggleOrbits = () => {\n    for (const body of this.bodies) {\n      if (body.orbit) {\n        body.orbit.visible = !body.orbit.visible;\n      }\n    }\n  };\n\n  private toggleAsteroidBelts = () => {\n    const abs = this.bodies.filter((b) => b.params.entityType === EntityType.AsteroidBelt);\n    for (const ab of abs) {\n      ab.entity.visible = !ab.entity.visible;\n    }\n  };\n\n  /**\n   * Might have to rework this if multi-star systems are added\n   * but for now it saves updating the orbit controls each render frame if we're just looking at the star\n   */\n  private onFollowPlanetNameChange = () => {\n    if (this.options.followPlanetName === \"Star 1\") {\n      this.orbitControls.target.set(0, 0, 0);\n      this.orbitControls.update();\n    }\n  };\n\n  /**\n   * Renders a 1000th scale model of the solar system\n   */\n  private renderRealisticSolarSystem = async () => {\n    // scale radiuses and speeds down to displayable proportions\n    const viewScale = 1 / 1000;\n\n    for (const star of this.solarSystem.stars) {\n      const radius = star.radius * viewScale;\n      const orbitRadius = star.orbitRadius * viewScale;\n      const orbitSpeed = star.orbitSpeed * viewScale;\n\n      const starEntity = new Star(radius, {\n        ...star,\n        colour: new Color(0xffca20),\n        orbitRadius: orbitRadius,\n        orbitSpeed: orbitSpeed,\n      });\n      await starEntity.create();\n      this.bodies.push(starEntity);\n      this.scene.add(starEntity.entity);\n\n      for (let planetIndex = 0; planetIndex < star.satellites.length; planetIndex++) {\n        const starSatellite = star.satellites[planetIndex];\n\n        const radius = starSatellite.radius * viewScale;\n        const orbitRadius = starSatellite.orbitRadius * viewScale;\n        const orbitSpeed = starSatellite.orbitSpeed * viewScale;\n\n        const orbitEntity = this.bodies.find((b) => b.params.id === starSatellite.orbitEntityId) as Entity;\n\n        if (starSatellite.entityType === EntityType.Planet) {\n          const planetParams: EntityParams = {\n            ...starSatellite,\n            orbitEntity: orbitEntity,\n            orbitRadius: orbitRadius,\n            orbitSpeed: orbitSpeed,\n            hasLabel: true,\n            onShow: this.handleShowPlanet,\n          };\n\n          const planetEntity = planetIndex === 2 ? new Earth(radius, planetParams) : new ClassM(radius, planetParams);\n          await planetEntity.create();\n\n          for (const moon of starSatellite.satellites) {\n            const radius = moon.radius * viewScale;\n            const orbitRadius = moon.orbitRadius * viewScale;\n            const orbitSpeed = moon.orbitSpeed * viewScale;\n\n            const orbitEntity = planetEntity;\n\n            const moonEntity = new Moon(radius, {\n              ...moon,\n              colour: moon.rgb ? new Color(...moon.rgb) : new Color(1, 1, 1),\n              orbitEntity: orbitEntity,\n              orbitRadius: orbitRadius,\n              orbitSpeed: orbitSpeed,\n            });\n            await moonEntity.create();\n            this.bodies.push(moonEntity);\n            // add the moon to the planet (so it follows the planet's orbit)\n            planetEntity.entity.add(moonEntity.entity);\n          }\n\n          this.bodies.push(planetEntity);\n          this.scene.add(planetEntity.entity);\n        } else if (starSatellite.entityType === EntityType.AsteroidBelt) {\n          const asteroidBelt = new AsteroidBelt(starSatellite.radius * 4, {\n            ...starSatellite,\n            colour: new Color(0.8, 0.8, 0.8),\n            orbitRadius: orbitRadius,\n            orbitEntity: starEntity,\n            orbitSpeed: orbitSpeed,\n          });\n\n          await asteroidBelt.create();\n          this.bodies.push(asteroidBelt);\n          this.scene.add(asteroidBelt.entity);\n        }\n      }\n    }\n  };\n\n  /**\n   * Renders a view friendly, compressed version of the solar system\n   */\n  private renderSolarSystem = async () => {\n    // scale radiuses and speeds down to displayable proportions\n    const viewScale = 1 / 1000;\n\n    for (const star of this.solarSystem.stars) {\n      const starRadius = star.radius * viewScale;\n      const orbitRadius = star.orbitRadius * viewScale;\n      const orbitSpeed = star.orbitSpeed * viewScale;\n\n      const starEntity = new Star(starRadius, {\n        ...star,\n        orbitRadius,\n        orbitSpeed,\n        colour: new Color(0xffca20),\n      });\n      await starEntity.create();\n      this.bodies.push(starEntity);\n      this.scene.add(starEntity.entity);\n\n      const starSatellites = cloneDeep(star.satellites);\n\n      // increase the radiuses (and moons)\n      for (const planet of starSatellites.filter((s) => s.entityType === EntityType.Planet)) {\n        planet.radius *= 4;\n        for (const moon of planet.satellites) {\n          moon.radius *= 2;\n          moon.orbitSpeed *= 2;\n          moon.orbitRadius *= 2;\n        }\n      }\n\n      // compress the orbits\n      for (let i = 0; i < starSatellites.length; i++) {\n        const starSatellite = starSatellites[i];\n\n        const planetMoonRadius = starSatellite.satellites.length\n          ? starSatellite.satellites[starSatellite.satellites.length - 1].orbitRadius\n          : 0;\n\n        if (i === 0) {\n          starSatellite.orbitRadius = star.radius * 2 + planetMoonRadius * 2;\n        } else {\n          const prevStarSatellite = starSatellites[i - 1];\n          const prevPlanetMoonRadius = prevStarSatellite.satellites.length\n            ? prevStarSatellite.satellites[prevStarSatellite.satellites.length - 1].orbitRadius\n            : prevStarSatellite.orbitRadius * 0.2;\n          starSatellite.orbitRadius = prevStarSatellite.orbitRadius + prevPlanetMoonRadius + planetMoonRadius;\n\n          // Extend the orbit slightly based on the actual orbit sizes\n          const r =\n            (starSatellite.orbitRadius - prevStarSatellite.orbitRadius) /\n            star.satellites[star.satellites.length - 1].orbitRadius;\n\n          starSatellite.orbitRadius += r * starSatellite.orbitRadius * 0.5;\n        }\n      }\n\n      for (let planetIndex = 0; planetIndex < starSatellites.length; planetIndex++) {\n        const starSatellite = starSatellites[planetIndex];\n\n        const radius = starSatellite.radius * viewScale;\n        const orbitRadius = starSatellite.orbitRadius * viewScale;\n        const orbitSpeed = starSatellite.orbitSpeed * viewScale;\n\n        const orbitEntity = this.bodies.find((b) => b.params.id === starSatellite.orbitEntityId) as Entity;\n\n        if (starSatellite.entityType === EntityType.Planet) {\n          const planetParams: EntityParams = {\n            ...starSatellite,\n            orbitEntity: orbitEntity,\n            orbitRadius: orbitRadius,\n            orbitSpeed: orbitSpeed,\n            hasLabel: true,\n            onShow: this.handleShowPlanet,\n          };\n\n          const planetEntity = planetIndex === 2 ? new Earth(radius, planetParams) : new ClassM(radius, planetParams);\n          await planetEntity.create();\n\n          for (const moon of starSatellite.satellites) {\n            const radius = moon.radius * viewScale;\n            const orbitRadius = moon.orbitRadius * viewScale;\n            const orbitSpeed = moon.orbitSpeed * viewScale * 3; // 3 = fudge factor to get moons moving\n            const orbitEntity = planetEntity;\n\n            const moonEntity = new Moon(radius, {\n              ...moon,\n              colour: moon.rgb ? new Color(...moon.rgb) : new Color(1, 1, 1),\n              orbitEntity: orbitEntity,\n              orbitRadius: orbitRadius,\n              orbitSpeed: orbitSpeed,\n            });\n            await moonEntity.create();\n            this.bodies.push(moonEntity);\n            // add the moon to the planet (so it follows the planet's orbit)\n            planetEntity.entity.add(moonEntity.entity);\n          }\n\n          this.bodies.push(planetEntity);\n          this.scene.add(planetEntity.entity);\n        } else if (starSatellite.entityType === EntityType.AsteroidBelt) {\n          const asteroidBelt = new AsteroidBelt(starSatellite.radius * viewScale, {\n            ...starSatellite,\n            colour: new Color(0.5, 0.5, 0.5),\n            orbitRadius: orbitRadius,\n            orbitEntity: starEntity,\n            orbitSpeed: orbitSpeed,\n            itemCount: Number(starSatellite.itemCount) * 0.2,\n          });\n\n          await asteroidBelt.create();\n          this.bodies.push(asteroidBelt);\n          this.scene.add(asteroidBelt.entity);\n        }\n      }\n    }\n  };\n}\n","import \"normalize.css\";\nimport \"./index.css\";\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport { App } from \"./components/App/App\";\nimport { SolarSystemApp } from \"./app/SolarSystemApp\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App solarSystemApp={new SolarSystemApp()}></App>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}