{"version":3,"sources":["app/entities/Entity.ts","components/LoadingIndicator/LoadingIndicator.tsx","components/PlanetDataSheet/PlanetDataSheet.tsx","components/App/App.tsx","app/utils/NoiseMapGenerator.ts","app/utils/planetNames.ts","app/utils/Random.ts","app/utils/SolarSystemGenerator.ts","app/entities/Moon.ts","app/entities/ClassM.ts","app/entities/Star.ts","app/entities/Earth.ts","index.tsx","app/SolarSystemApp.ts"],"names":["EntityType","verbs","adjectives","nouns","randomArrayValue","array","min","max","length","Math","floor","random","LoadingIndicator","show","className","PlanetDataSheet","planet","properties","name","radius","toLocaleString","moons","orbitRadius","orbitSpeed","orbitInclanation","map","prop","App","solarSystemApp","useState","isLoading","setIsLoading","undefined","selectedPlanet","setSelectedPlanet","useEffect","init","onInitialising","handleInitialising","onInitialised","handleInitialised","onSelectPlanet","handleSelectPlanet","NoiseMapGenerator","seed","noiseGenerator","this","SimplexNoise","width","height","x","y","noise","getMixedFrequencyNoise","pow","makeSeamlessVertically","makeSeamlessHorizontally","frequency","xOffset","yOffset","_x","_y","amplitude","n","noise2D","frequencies","sumOfAmplitudes","reduce","previous","index","getNoise","noiseMap","stitchWidth","v","o","MathUtils","lerp","stitchHeight","k","ceil","s1","s2","c","Entity","id","entityType","params","entity","sphere","orbit","textureWidth","textureHeight","maxTerrainHeight","loader","TextureLoader","sphereGeometry","orbitGeometry","material","heightMapTexture","colourMapTexture","texture","labelContext","labelTexture","labelSprite","labelScaleVector","Vector3","labelAspectRatio","Group","terrainHeight","terrainMaps","generateTerrainMaps","CanvasTexture","heightMap","canvas","mapping","EquirectangularReflectionMapping","MeshPhongMaterial","bumpMap","bumpScale","displacementMap","displacementScale","texturePath","loadAsync","MeshBasicMaterial","color","colour","SphereBufferGeometry","Mesh","castShadow","receiveShadow","hasLabel","addLabel","add","orbitEntity","orbitEntityPos","position","createOrbitCircle","set","z","rotation","degToRad","orbitStartPosition","clock","speed","camera","showLabels","getElapsedTime","orbitDirection","spinSpeed","perSecond","spinDirection","visible","scale","subVectors","onShow","dispose","_dispose","heightMapContext","getCanvasContext","heightMapImageData","createImageData","heightMapData","data","colourMapContext","colourMapImageData","colourMapData","baseSeed","acc","cur","generateNoiseMap","i","colourValue","heightColour","ci","mapColour","getMapColour","putImageData","level","lerpColour","dark","light","col1","col2","ratio","convertToColor","toArray","Color","setRGB","ctx","document","createElement","getContext","fillStyle","fillRect","BufferGeometry","verts","LineBasicMaterial","opacity","transparent","theta","PI","push","cos","sin","vertices","Float32Array","setAttribute","BufferAttribute","Line","font","textAlign","fillText","fontSize","Texture","needsUpdate","spriteMaterial","SpriteMaterial","Sprite","planetNames","Random","mt19937","factory","rand","getRandom","getRandomInt","x0","y0","z0","u","phi","acos","solarSystemValues","seedIndexes","SolarSystemGenerator","entityId","solarSystem","stars","planets","starRadius","getNextId","orbitEntityId","getRandomFloat","coinToss","starIndex","star","numberOfPlanets","planetOrbitRadiuses","createPlanetOrbitRadiuses","planetIndex","planetRadius","createPlanet","numberOfMoons","moonOrbitRadiuses","Array","fill","item","sort","a","b","moonIndex","moonRadius","moon","createMoon","distanceFromStar","furthestPlanetOrbitRadius","po1","distanceBetween","randomOrbitDirection","randomSpinSpeed","rgb","getRandomRgb","planetName","getRandomFromArray","Moon","r","g","rgba","ClassM","colours","oceanDark","getRandomColour","oceanLight","beachDark","beachLight","forestDark","forestLight","jungleDark","jungleLight","savannahDark","savannahLight","desertDark","desertLight","snowDark","snowLight","getColourForHeight","getRangeColour","colIndex","Star","Earth","ReactDOM","render","StrictMode","isRunning","scene","Clock","bodies","renderer","orbitControls","stats","showPlanetId","cameraInitialPosition","spaceTexture","gui","guiViewActionsFolder","guiPlanetsFolder","planetPositionVector","ambientLight","pointLight","options","simulationSpeed","showOrbits","followPlanetName","trueScale","showPlanetLabels","showStats","buttonHandlers","resetView","newSeed","randInt","changeSeed","updateDisplay","clearScene","generate","_init","then","animate","AmbientLight","PointLight","renderRealisticSolarSystem","renderSolarSystem","divideScalar","filter","Planet","addFolder","open","p","onChange","onFollowPlanetNameChange","toggleOrbits","requestAnimationFrame","forEach","body","dom","style","display","update","find","getWorldPosition","lookAt","target","removeFolder","destroy","error","clear","handleShowPlanet","viewScale","starEntity","create","planetParams","planetEntity","moonEntity","cloneDeep","planetMoonRadius","prevPlanet","prevPlanetMoonRadius","Scene","background","setHex","CubeTextureLoader","load","Camera","PerspectiveCamera","window","innerWidth","innerHeight","WebGLRenderer","powerPreference","antialias","setSize","setPixelRatio","devicePixelRatio","shadowMap","enabled","appendChild","domElement","OrbitControls","enableDamping","Stats","GUI","onFinishChange","getElementById"],"mappings":"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,IAAIkH,IAAOF,GAG9BzK,KAAK0C,OAAO4C,IAAItF,KAAKyD,iBA1RzB,K,2BKzDamH,EAAc,CACzB,WACA,WACA,UACA,WACA,WACA,SACA,UACA,UACA,QACA,SACA,WACA,YACA,YACA,WACA,QACA,QACA,SACA,SACA,WACA,SACA,YACA,SACA,SACA,WACA,SACA,OACA,WACA,UACA,YACA,SACA,YACA,aACA,SACA,UACA,UACA,SACA,UACA,UACA,UACA,cACA,cACA,aACA,aACA,SACA,WACA,aACA,YACA,UACA,WACA,cACA,aACA,WACA,YACA,SACA,SACA,UACA,OACA,OACA,QACA,OACA,QACA,QACA,QACA,UACA,QACA,QACA,SACA,UACA,UACA,aACA,WACA,YACA,UACA,WACA,UACA,WACA,WACA,QACA,SACA,QACA,QACA,SACA,UACA,SACA,SACA,WACA,UACA,UACA,SACA,cACA,UACA,SACA,SACA,WACA,SACA,WACA,UACA,YACA,YACA,SACA,aACA,UACA,UACA,aACA,gBACA,WACA,YACA,WACA,UACA,WACA,WACA,WACA,WACA,QACA,QACA,cACA,OACA,QACA,SACA,YACA,UACA,SACA,SACA,WACA,YACA,QACA,OACA,SACA,eACA,SACA,UACA,SACA,WACA,WACA,QACA,SACA,WACA,SACA,WACA,SACA,WACA,UACA,YACA,UACA,QACA,cACA,YACA,SACA,SACA,SACA,OACA,WACA,QACA,UACA,WACA,WACA,QACA,SACA,SACA,OACA,UACA,SACA,UACA,UACA,SACA,YACA,WACA,OACA,KACA,MACA,QACA,SACA,WACA,UACA,UACA,OACA,MACA,OACA,WACA,aACA,SACA,QACA,UACA,WACA,YACA,aACA,WACA,UACA,UACA,QACA,QACA,SACA,WACA,QACA,UACA,QACA,SACA,WACA,OACA,OACA,UACA,WACA,WACA,QACA,SACA,SACA,QACA,WACA,WACA,gBACA,UACA,SACA,SACA,SACA,UACA,OACA,QACA,QACA,WACA,aACA,UACA,MACA,SACA,SACA,gBACA,SACA,SACA,QACA,QACA,SACA,QACA,YACA,YACA,aACA,OACA,OACA,WACA,WACA,QACA,OACA,SACA,WACA,QACA,SACA,gBACA,gBACA,cACA,aACA,YACA,aACA,aACA,SACA,aACA,QACA,UACA,WACA,WACA,QACA,SACA,UACA,SACA,kBACA,KACA,UACA,QACA,YACA,UACA,OACA,SACA,QACA,QACA,UACA,OACA,UACA,WACA,QACA,UACA,SACA,QACA,UACA,iBACA,QACA,QACA,SACA,QACA,aACA,UACA,QACA,OACA,SACA,UACA,OACA,QACA,iBACA,MACA,QACA,OACA,SACA,SACA,QACA,OACA,QACA,YACA,UACA,QACA,QACA,SACA,UACA,WACA,YACA,SACA,WACA,WACA,YACA,SACA,SACA,QACA,QACA,UACA,QACA,WACA,YACA,QACA,aACA,QACA,cACA,WACA,OACA,OACA,QACA,WACA,QACA,SACA,UACA,YACA,QACA,UACA,cACA,SACA,SACA,SACA,SACA,OACA,QACA,SACA,QACA,KACA,YACA,WACA,SACA,MACA,WACA,SACA,UACA,UACA,iBACA,UACA,WACA,UACA,QACA,SACA,aACA,cACA,MACA,UACA,QACA,UACA,UACA,YACA,KACA,SACA,MACA,MACA,UACA,QACA,WACA,SACA,QACA,YACA,cACA,YACA,UACA,UACA,SACA,SACA,UACA,WACA,WACA,YACA,YACA,cACA,UACA,UACA,WACA,WACA,cACA,YACA,UACA,aACA,UACA,YACA,YACA,WACA,OACA,SACA,YACA,aACA,WACA,YACA,aACA,aACA,WACA,SACA,aACA,UACA,WACA,QACA,UACA,SACA,aACA,aACA,aACA,UACA,SACA,YACA,UACA,SACA,WACA,eACA,UACA,MACA,OACA,UACA,WACA,SACA,aACA,SACA,SACA,SACA,SACA,SACA,UACA,WACA,QACA,SACA,WACA,MACA,SACA,SACA,SACA,SACA,QACA,OACA,cACA,SACA,QACA,WACA,QACA,YACA,WACA,aACA,SACA,S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","file":"static/js/main.32b9d331.chunk.js","sourcesContent":["import {\n  CanvasTexture,\n  Clock,\n  Color,\n  EquirectangularReflectionMapping,\n  Group,\n  Line,\n  LineBasicMaterial,\n  Material,\n  Mesh,\n  MeshBasicMaterial,\n  MeshPhongMaterial,\n  SphereBufferGeometry,\n  TextureLoader,\n  Vector3,\n  BufferGeometry,\n  BufferAttribute,\n  Texture,\n  MathUtils,\n  SpriteMaterial,\n  Sprite,\n  Camera,\n} from \"three\";\n\nimport { NoiseMapGenerator } from \"../utils/NoiseMapGenerator\";\n\nexport enum EntityType {\n  Star,\n  Planet,\n  Moon,\n}\n\ntype TerrainMaps = {\n  heightMap: CanvasRenderingContext2D;\n  map: CanvasRenderingContext2D;\n};\n\nexport type EntityParams = {\n  baseSeed: number[];\n  position: Vector3;\n  orbitEntity: Entity | false;\n  orbitDirection: number;\n  orbitSpeed: number;\n  orbitRadius: number;\n  orbitInclanation: number;\n  orbitStartPosition: number;\n  spinSpeed: number;\n  spinDirection: number;\n\n  terrainHeight?: number;\n  colour?: Color;\n  castShadow?: boolean;\n  receiveShadow?: boolean;\n  texturePath?: string;\n  onShow?: (id: number) => void;\n  hasLabel?: boolean;\n};\n\nexport abstract class Entity {\n  public id: number;\n  public name: string;\n  public entityType: EntityType;\n  public entity: Group;\n  public params: EntityParams;\n  public radius: number;\n  public sphere!: Mesh;\n  public orbit!: Material;\n\n  protected textureWidth: number;\n  protected textureHeight: number;\n  protected abstract maxTerrainHeight: number;\n\n  private loader = new TextureLoader();\n  private sphereGeometry!: SphereBufferGeometry;\n  private orbitGeometry!: BufferGeometry;\n  private material!: Material;\n  private heightMapTexture!: CanvasTexture;\n  private colourMapTexture!: CanvasTexture;\n  private texture!: Texture;\n\n  private labelContext!: CanvasRenderingContext2D;\n  private labelTexture!: Texture;\n  private labelSprite!: Sprite;\n  private labelScaleVector = new Vector3();\n  private labelAspectRatio!: number;\n\n  constructor(id: number, name: string, entityType: EntityType, radius: number, params: EntityParams) {\n    this.id = id;\n    this.name = name;\n    this.entityType = entityType;\n    this.radius = radius;\n    this.params = params;\n\n    this.entity = new Group();\n\n    this.textureWidth = 512;\n    this.textureHeight = 256;\n  }\n\n  public async create() {\n    if (this.params.terrainHeight && this.params.terrainHeight > 0) {\n      const terrainMaps = this.generateTerrainMaps();\n\n      this.heightMapTexture = new CanvasTexture(terrainMaps.heightMap.canvas);\n      this.colourMapTexture = new CanvasTexture(terrainMaps.map.canvas);\n\n      this.heightMapTexture.mapping = EquirectangularReflectionMapping;\n      this.colourMapTexture.mapping = EquirectangularReflectionMapping;\n\n      const terrainHeight = Math.ceil(this.params.terrainHeight * this.maxTerrainHeight);\n\n      this.material = new MeshPhongMaterial({\n        bumpMap: this.heightMapTexture,\n        bumpScale: terrainHeight,\n        map: this.colourMapTexture,\n        displacementMap: this.heightMapTexture,\n        displacementScale: terrainHeight,\n      });\n    } else {\n      if (this.params.texturePath) {\n        this.texture = await this.loader.loadAsync(this.params.texturePath);\n        this.material = new MeshBasicMaterial({ map: this.texture, color: this.params.colour });\n      } else {\n        this.material = new MeshBasicMaterial({\n          color: this.params.colour,\n        });\n      }\n    }\n\n    this.sphereGeometry = new SphereBufferGeometry(this.radius, 64, 48);\n    this.sphere = new Mesh(this.sphereGeometry, this.material);\n\n    this.sphere.castShadow = !!this.params.castShadow;\n    this.sphere.receiveShadow = !!this.params.receiveShadow;\n\n    if (this.params.hasLabel) {\n      this.addLabel();\n    }\n\n    this.entity.add(this.sphere);\n\n    if (this.params.orbitEntity) {\n      const orbitEntityPos = this.params.orbitEntity.sphere.position;\n      const orbitRadius = this.params.orbitRadius || 400;\n\n      // create an orbit cirlce and add it to the entity\n      const orbit = this.createOrbitCircle(orbitRadius);\n      this.entity.add(orbit);\n\n      // position the sphere at the edge of the orbit circle\n      this.sphere.position.set(orbitRadius, 0, 0);\n\n      // position the whole entity at the orbit entity position\n      this.entity.position.set(orbitEntityPos.x, orbitEntityPos.y, orbitEntityPos.z);\n\n      // set orbit inclanation/tilt\n      this.entity.rotation.x = MathUtils.degToRad(this.params.orbitInclanation);\n\n      // set initial orbit position\n      this.entity.rotation.y = MathUtils.degToRad(360 * this.params.orbitStartPosition);\n    }\n\n    return this;\n  }\n\n  public animate(clock: Clock, speed: number, camera: Camera, showLabels: boolean) {\n    clock.getElapsedTime();\n\n    if (this.params.orbitEntity) {\n      // (/60=mins /60=seconds /60=account for framerate)\n      const perSecond = this.params.orbitSpeed / 60 / 60 / 60;\n\n      const orbitSpeed = perSecond * speed;\n      const orbitDirection = this.params.orbitDirection;\n\n      // as our planet/moon is positioned at the edge of our orbit circle\n      // \"orbiting\" is simply a matter of rotating the whole entity :)\n      this.entity.rotation.y += orbitSpeed * orbitDirection;\n    }\n\n    if (this.params.spinSpeed) {\n      const perSecond = this.params.spinSpeed / 60 / 60 / 60;\n      this.sphere.rotation.y += perSecond * speed * this.params.spinDirection;\n    }\n\n    if (this.params.hasLabel) {\n      this.labelSprite.visible = showLabels;\n      if (showLabels) {\n        // keep the label the same size regardless of camera zoom\n        const scaleFactor = 24;\n        const scale = this.labelScaleVector.subVectors(this.sphere.position, camera.position).length() / scaleFactor;\n        this.labelSprite.scale.set(scale, scale * this.labelAspectRatio, 1);\n        this.labelSprite.position.y = this.radius;\n      }\n    }\n  }\n\n  public show() {\n    if (this.params.onShow) {\n      this.params.onShow(this.id);\n    }\n  }\n\n  protected abstract _dispose(): void;\n  public dispose() {\n    // geometries\n    this.sphereGeometry?.dispose();\n    this.orbitGeometry?.dispose();\n\n    // materials\n    this.orbit?.dispose();\n    this.material?.dispose();\n\n    // textures\n    this.heightMapTexture?.dispose();\n    this.colourMapTexture?.dispose();\n    this.texture?.dispose();\n    this.labelTexture?.dispose();\n\n    // call implemented dispose method\n    this._dispose();\n  }\n\n  protected generateTerrainMaps(): TerrainMaps {\n    const recordSize = 4;\n\n    const heightMapContext = this.getCanvasContext();\n    const heightMapImageData = heightMapContext.createImageData(this.textureWidth, this.textureHeight);\n    const heightMapData = heightMapImageData.data;\n\n    const colourMapContext = this.getCanvasContext();\n    const colourMapImageData = colourMapContext.createImageData(this.textureWidth, this.textureHeight);\n    const colourMapData = colourMapImageData.data;\n\n    const seed = [...this.params.baseSeed, 99999].reduce((acc, cur) => (acc += cur));\n    const ng = new NoiseMapGenerator(seed);\n    const noiseMap = ng.generateNoiseMap(this.textureWidth, this.textureHeight);\n\n    for (let i = 0; i < heightMapData.length; i += recordSize) {\n      const x = (i / recordSize) % this.textureWidth;\n      const y = ~~(i / recordSize / this.textureWidth);\n\n      const noise = noiseMap[x][y];\n      const generatedColourValue = 255 * noise;\n\n      let colourValue = generatedColourValue;\n\n      // RGBA\n      const heightColour = [colourValue, colourValue, colourValue, 255];\n      for (let ci = 0; ci < heightColour.length; ci++) {\n        heightMapData[i + ci] = heightColour[ci];\n      }\n\n      let mapColour = this.getMapColour(colourValue, y);\n\n      for (let ci = 0; ci < mapColour.length; ci++) {\n        colourMapData[i + ci] = mapColour[ci];\n      }\n    }\n\n    heightMapContext.putImageData(heightMapImageData, 0, 0);\n    colourMapContext.putImageData(colourMapImageData, 0, 0);\n\n    return {\n      heightMap: heightMapContext,\n      map: colourMapContext,\n    };\n  }\n\n  protected abstract getMapColour(height: number, y: number): number[];\n\n  protected getRangeColour(level: { min: number; max: number; dark: number[]; light: number[] }, height: number) {\n    return this.lerpColour(level.dark, level.light, (height - level.min) / (level.max - level.min));\n  }\n\n  protected lerpColour(col1: number[], col2: number[], ratio: number) {\n    const c = this.convertToColor(col1).lerp(this.convertToColor(col2), ratio);\n    return [...c.toArray(), 255];\n  }\n\n  protected convertToColor(colour: number[]) {\n    return new Color().setRGB(colour[0], colour[1], colour[2]);\n  }\n\n  protected getCanvasContext() {\n    const ctx = document.createElement(\"canvas\").getContext(\"2d\") as CanvasRenderingContext2D;\n    ctx.canvas.width = this.textureWidth;\n    ctx.canvas.height = this.textureHeight;\n    ctx.fillStyle = \"#fff\";\n    ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n    return ctx;\n  }\n\n  private createOrbitCircle(radius: number) {\n    var segmentCount = 128;\n    this.orbitGeometry = new BufferGeometry();\n    const verts = [];\n    this.orbit = new LineBasicMaterial({ color: 0xffffff, opacity: 0.5, transparent: true });\n\n    for (var i = 0; i <= segmentCount; i++) {\n      var theta = (i / segmentCount) * Math.PI * 2;\n      verts.push(Math.cos(theta) * radius, 0, Math.sin(theta) * radius);\n    }\n    const vertices = new Float32Array(verts);\n    this.orbitGeometry.setAttribute(\"position\", new BufferAttribute(vertices, 3));\n    return new Line(this.orbitGeometry, this.orbit);\n  }\n\n  private addLabel() {\n    this.labelContext = document.createElement(\"canvas\").getContext(\"2d\") as CanvasRenderingContext2D;\n\n    const fontSize = 44;\n    this.labelContext.canvas.width = 384;\n    this.labelContext.canvas.height = 384;\n\n    this.labelContext.font = `${fontSize}pt 'Lucida Grande', sans-serif`;\n    // const textWidth = this.labelContext.measureText(this.name).width;\n\n    // this.labelContext.canvas.width = textWidth;\n    // this.labelContext.canvas.height = fontSize * 1.5;\n\n    this.labelAspectRatio = this.labelContext.canvas.height / this.labelContext.canvas.width;\n    // console.log(this.name, this.labelAspectRatio);\n\n    // this.labelContext.fillStyle = \"rgba(255,0,0,0.2)\";\n    // this.labelContext.fillRect(0, 0, this.labelContext.canvas.width, this.labelContext.canvas.height);\n\n    this.labelContext.fillStyle = \"white\";\n    this.labelContext.textAlign = \"center\";\n    this.labelContext.fillText(this.name, this.labelContext.canvas.width / 2, fontSize + 1);\n\n    this.labelTexture = new Texture(this.labelContext.canvas);\n    this.labelTexture.needsUpdate = true;\n    const spriteMaterial = new SpriteMaterial({\n      map: this.labelTexture,\n      transparent: true,\n    });\n    this.labelSprite = new Sprite(spriteMaterial);\n    // this.labelSprite.position.y = this.radius * 0.4;\n\n    this.sphere.add(this.labelSprite);\n  }\n}\n","import React from \"react\";\n\nimport \"./LoadingIndicator.css\";\n\ntype Props = {\n  show?: boolean;\n};\n\nconst verbs = [\n  \"annihilating\",\n  \"balancing\",\n  \"brewing\",\n  \"charging\",\n  \"dispatching\",\n  \"exciting\",\n  \"generating\",\n  \"initialising\",\n  \"isolating \",\n  \"letting loose\",\n  \"manifesting\",\n  \"mining\",\n  \"randomising\",\n  \"scintilating\",\n  \"televising\",\n];\n\nconst adjectives = [\n  \"asynchronous\",\n  \"correlating\",\n  \"crystaline\",\n  \"high-energy\",\n  \"isomorphic\",\n  \"molecular\",\n  \"multi-valent \",\n  \"resonant\",\n  \"vibrational\",\n];\n\nconst nouns = [\n  \"astral fields\",\n  \"astral planes\",\n  \"bose-einstein condensate\",\n  \"consciousness\",\n  \"design elements\",\n  \"gravity wells\",\n  \"harmonics\",\n  \"lightening fields\",\n  \"meson clouds\",\n  \"neutron masses\",\n  \"physics\",\n  \"plasma\",\n  \"relativistic speeds\",\n  \"singularities\",\n  \"space-time fragmentation\",\n  \"string theory\",\n  \"warp fields\",\n];\n\nconst randomIntFromInterval = (min: number, max: number) => {\n  // min and max included\n  return Math.floor(Math.random() * (max - min + 1) + min);\n};\n\nconst randomArrayValue = (array: any[]) => {\n  return array[randomIntFromInterval(0, array.length - 1)];\n};\n\nconst getRandomMessage = () => {\n  return `${randomArrayValue(verbs)} ${randomArrayValue(adjectives)} ${randomArrayValue(nouns)}...`;\n};\n\nexport const LoadingIndicator: React.FC<Props> = ({ show }) => {\n  if (!show) {\n    return null;\n  }\n\n  return <div className=\"loading-indicator\">{getRandomMessage()}</div>;\n};\n","import { SolarSystemEntity } from \"../../app/models/SolarSystem\";\nimport \"./PlanetDataSheet.css\";\n\ntype Props = {\n  planet?: SolarSystemEntity;\n};\n\nexport const PlanetDataSheet: React.FC<Props> = ({ planet }) => {\n  if (!planet) {\n    return null;\n  }\n\n  const properties = [\n    [\"Name\", planet.name],\n    [\"Diameter (km)\", (planet.radius * 2).toLocaleString()],\n    [\"Moons\", planet.moons.length],\n    [\"Orbit Distance (km)\", planet.orbitRadius.toLocaleString()],\n    [\"Orbital Speed (km/h)\", Math.floor(planet.orbitSpeed).toLocaleString()],\n    [\"Orbital Inclanation (Â°)\", planet.orbitInclanation],\n  ];\n\n  return (\n    <div className=\"planet-datasheet\">\n      <h2>Planet Info</h2>\n\n      <ul className=\"planet-datasheet__property-list\">\n        {properties.map((prop) => (\n          <li key={prop[0]} className=\"planet-datasheet__property\">\n            <strong>{prop[0]}</strong>\n            <p>{prop[1]}</p>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n};\n","import React, { useEffect, useState } from \"react\";\nimport { LoadingIndicator } from \"../LoadingIndicator/LoadingIndicator\";\nimport { SolarSystemApp } from \"../../app/SolarSystemApp\";\nimport { PlanetDataSheet } from \"../PlanetDataSheet/PlanetDataSheet\";\nimport { SolarSystemEntity } from \"../../app/models/SolarSystem\";\n\ntype Props = {\n  solarSystemApp: SolarSystemApp;\n};\n\nexport const App: React.FC<Props> = ({ solarSystemApp }) => {\n  const [isLoading, setIsLoading] = useState(true);\n  const [selectedPlanet, setSelectedPlanet] = useState<SolarSystemEntity | undefined>(undefined);\n\n  useEffect(() => {\n    solarSystemApp.init();\n    solarSystemApp.onInitialising = handleInitialising;\n    solarSystemApp.onInitialised = handleInitialised;\n    solarSystemApp.onSelectPlanet = handleSelectPlanet;\n  }, [solarSystemApp]);\n\n  const handleInitialising = () => {\n    setIsLoading(true);\n  };\n\n  const handleInitialised = () => {\n    setIsLoading(false);\n  };\n\n  const handleSelectPlanet = (planet?: SolarSystemEntity) => {\n    setSelectedPlanet(planet);\n  };\n\n  return (\n    <>\n      <LoadingIndicator show={isLoading} />\n      <PlanetDataSheet planet={selectedPlanet}></PlanetDataSheet>\n    </>\n  );\n};\n","import SimplexNoise from \"simplex-noise\";\nimport { MathUtils } from \"three\";\n\nexport class NoiseMapGenerator {\n  private noiseGenerator: SimplexNoise;\n\n  constructor(seed?: number) {\n    this.noiseGenerator = new SimplexNoise(seed);\n  }\n\n  public generateNoiseMap(width: number, height: number): number[][] {\n    const map: number[][] = [];\n\n    for (let x = 0; x < width; x++) {\n      map[x] = [];\n      for (let y = 0; y < height; y++) {\n        // add noise at various frequencies\n        let noise = this.getMixedFrequencyNoise(\n          x,\n          y,\n          [0.01, 0.02, 0.04, 0.08, 0.16, 0.32, 0.64, 1.28]\n        );\n        noise = Math.pow(noise, 2.3);\n\n        map[x][y] = noise;\n      }\n    }\n\n    this.makeSeamlessVertically(map, height * 0.2);\n    this.makeSeamlessHorizontally(map, width * 0.05);\n\n    return map;\n  }\n\n  private getNoise(\n    x: number,\n    y: number,\n    frequency: number,\n    xOffset: number = 0,\n    yOffset: number = 0\n  ) {\n    const _x = frequency * x + xOffset;\n    const _y = frequency * y + yOffset;\n    const amplitude = 1 / frequency;\n\n    // get noise in the range 0-1\n    const n = this.noiseGenerator.noise2D(_x, _y) / 2 + 0.5;\n\n    let noise = amplitude * n;\n    return noise;\n  }\n\n  private getMixedFrequencyNoise(x: number, y: number, frequencies: number[]) {\n    let sumOfAmplitudes = 0;\n    const noise = frequencies.reduce(\n      (previous: number, frequency: number, index: number) => {\n        sumOfAmplitudes += 1 / frequency;\n\n        // add offsets so different frequencies (octaves)\n        // sample from a different part of the noise space\n        const xOffset = index * 10;\n        const yOffset = index * 100;\n        return previous + this.getNoise(x, y, frequency, xOffset, yOffset);\n      },\n      0\n    );\n    return noise / sumOfAmplitudes;\n  }\n\n  // ported from here:\n  // https://medium.com/nerd-for-tech/making-a-seamless-perlin-noise-in-c-4cfc12a90f93\n  private makeSeamlessHorizontally(noiseMap: number[][], stitchWidth: number) {\n    const width = noiseMap.length;\n    const height = noiseMap[0].length;\n\n    // iterate on the stitch band (on the left\n    // of the noise)\n    for (let x = 0; x < stitchWidth; x++) {\n      // get the transparency value from\n      // a linear gradient\n      const v = x / stitchWidth;\n\n      for (let y = 0; y < height; y++) {\n        // compute the \"mirrored x position\":\n        // the far left is copied on the right\n        // and the far right on the left\n        const o = ~~(width - stitchWidth + x);\n        // copy the value on the right of the noise\n        noiseMap[o][y] = MathUtils.lerp(\n          noiseMap[o][y],\n          noiseMap[~~(stitchWidth - x)][y],\n          v\n        );\n      }\n    }\n  }\n\n  // ported from here:\n  // https://medium.com/nerd-for-tech/making-a-seamless-perlin-noise-in-c-4cfc12a90f93\n  private makeSeamlessVertically(noiseMap: number[][], stitchHeight: number) {\n    const width = noiseMap.length;\n    const height = noiseMap[0].length;\n\n    // iterate through the stitch band (both\n    // top and bottom sides are treated\n    // simultaneously because its mirrored)\n    for (let y = 0; y < stitchHeight; y++) {\n      // number of neighbour pixels to\n      // consider for the average (= kernel size)\n      const k = Math.ceil(stitchHeight - y);\n      // go through the entire row\n      for (let x = 0; x < width; x++) {\n        // compute the sum of pixel values\n        // in the top and the bottom bands\n        let s1 = 0.0;\n        let s2 = 0.0;\n        let c = 0;\n        for (let o = x - k; o < x + k; o++) {\n          if (o < 0 || o >= width) {\n            continue;\n          }\n\n          s1 += noiseMap[o][y];\n          s2 += noiseMap[o][height - y - 1];\n          c++;\n        }\n        // compute the means and assign them to\n        // the pixels in the top and the bottom\n        // rows\n        noiseMap[x][y] = s1 / c;\n        noiseMap[x][height - y - 1] = s2 / c;\n      }\n    }\n  }\n}\n","// https://www.imagineforest.com/blog/planet-name-generator/\nexport const planetNames = [\n  \"Acanthis\",\n  \"Achelous\",\n  \"Acheron\",\n  \"Achilles\",\n  \"Achilles\",\n  \"Achlys\",\n  \"Actaeon\",\n  \"Admetus\",\n  \"Adoni\",\n  \"Aeacus\",\n  \"AÃ«don\",\n  \"AeÃ«tes\",\n  \"Aegisthus\",\n  \"Aegyptus\",\n  \"Aella\",\n  \"Aello\",\n  \"Aeneas\",\n  \"Aeolus\",\n  \"Aeternae\",\n  \"Aethon\",\n  \"Agamemnon\",\n  \"Aglaia\",\n  \"Agreus\",\n  \"Agriopas\",\n  \"Agrius\",\n  \"Ajax\",\n  \"Alcestis\",\n  \"Alcyone\",\n  \"Alcyoneus\",\n  \"Alecto\",\n  \"Alectryon\",\n  \"Alkyonides\",\n  \"Almops\",\n  \"Aloadae\",\n  \"Althaea\",\n  \"Amazon\",\n  \"Amazons\",\n  \"Ampelos\",\n  \"Amphion\",\n  \"Amphisbaena\",\n  \"Amphithemis\",\n  \"Amphitrite\",\n  \"Amphitryon\",\n  \"Amycus\",\n  \"Anchises\",\n  \"Andromache\",\n  \"Andromeda\",\n  \"Anteros\",\n  \"Antigone\",\n  \"AntinoÃ¼s\",\n  \"Antiphates\",\n  \"Aphrodit\",\n  \"Aphrodite\",\n  \"Apollo\",\n  \"Aquilo\",\n  \"Arachne\",\n  \"Arae\",\n  \"Ares\",\n  \"Arges\",\n  \"Argo\",\n  \"Argos\",\n  \"Argus\",\n  \"Argus\",\n  \"Ariadne\",\n  \"Arion\",\n  \"Arion\",\n  \"Artemi\",\n  \"Artemis\",\n  \"Asbolus\",\n  \"Ascalaphus\",\n  \"Asclepiu\",\n  \"Asclepius\",\n  \"Astarte\",\n  \"Asterius\",\n  \"Astraea\",\n  \"Atalanta\",\n  \"Atalanta\",\n  \"Athen\",\n  \"Athena\",\n  \"Athos\",\n  \"Atlas\",\n  \"Atreus\",\n  \"Atropos\",\n  \"Aurora\",\n  \"Auster\",\n  \"Autonous\",\n  \"Avernus\",\n  \"Bacchus\",\n  \"Balius\",\n  \"Bellerophon\",\n  \"Bellona\",\n  \"Bienor\",\n  \"Boreas\",\n  \"Briareus\",\n  \"Cadmus\",\n  \"Calliope\",\n  \"Calypso\",\n  \"Carduelis\",\n  \"Cassandra\",\n  \"Castor\",\n  \"Catoblepas\",\n  \"Celaeno\",\n  \"Centaur\",\n  \"Centauride\",\n  \"Centauromachy\",\n  \"Centaurs\",\n  \"Centaurus\",\n  \"Cephalus\",\n  \"Cepheus\",\n  \"Ceramici\",\n  \"Cerastes\",\n  \"Cerberus\",\n  \"Cercopes\",\n  \"Ceres\",\n  \"Cetus\",\n  \"Ceuthonymus\",\n  \"Ceyx\",\n  \"Chaos\",\n  \"Charon\",\n  \"Charybdis\",\n  \"Chimera\",\n  \"Chiron\",\n  \"Chiron\",\n  \"Chryseis\",\n  \"Chthonius\",\n  \"Circe\",\n  \"Clio\",\n  \"Clotho\",\n  \"Clytemnestra\",\n  \"Cornix\",\n  \"Coronis\",\n  \"Corvus\",\n  \"Crocotta\",\n  \"Crommyon\",\n  \"Cronu\",\n  \"Cronus\",\n  \"Cyclopes\",\n  \"Cycnus\",\n  \"Cyllarus\",\n  \"Cyprus\",\n  \"Daedalus\",\n  \"Daemons\",\n  \"Damarchus\",\n  \"Damysus\",\n  \"Danae\",\n  \"DanaÃ¯des\",\n  \"DanaÃ¼s\",\n  \"Daphne\",\n  \"Demete\",\n  \"Dictys\",\n  \"Dido\",\n  \"Diomedes\",\n  \"Dione\",\n  \"Dionysu\",\n  \"Dionysus\",\n  \"Dioscuri\",\n  \"Dryad\",\n  \"Dryads\",\n  \"Echion\",\n  \"Echo\",\n  \"Eidolon\",\n  \"Elatus\",\n  \"Electra\",\n  \"Empousa\",\n  \"Empusa\",\n  \"Enceladus\",\n  \"Endymion\",\n  \"Enyo\",\n  \"Eo\",\n  \"Eos\",\n  \"Erato\",\n  \"Erebus\",\n  \"Eridanos\",\n  \"Erigone\",\n  \"Erinyes\",\n  \"Eris\",\n  \"Ero\",\n  \"Eros\",\n  \"Eteocles\",\n  \"Euphrosyne\",\n  \"Europa\",\n  \"Eurus\",\n  \"Euryale\",\n  \"Eurydice\",\n  \"Eurynomos\",\n  \"Eurystheus\",\n  \"Eurytion\",\n  \"Eurytus\",\n  \"Euterpe\",\n  \"Fates\",\n  \"Fauns\",\n  \"Faunus\",\n  \"Favonius\",\n  \"Flora\",\n  \"Fortuna\",\n  \"Furie\",\n  \"Furies\",\n  \"Gadflies\",\n  \"Gaea\",\n  \"Gaia\",\n  \"Galatea\",\n  \"Ganymede\",\n  \"Gegenees\",\n  \"Gello\",\n  \"Gerana\",\n  \"Geryon\",\n  \"giant\",\n  \"Giantess\",\n  \"Gigantes\",\n  \"Golden Fleece\",\n  \"Gorgons\",\n  \"Graces\",\n  \"Graeae\",\n  \"Graeae\",\n  \"Griffin\",\n  \"Hade\",\n  \"Hades\",\n  \"Hades\",\n  \"halcyons\",\n  \"Hamadryads\",\n  \"Harpies\",\n  \"Heb\",\n  \"Hecate\",\n  \"Hecate\",\n  \"Hecatonchires\",\n  \"Hector\",\n  \"Hecuba\",\n  \"Helen\",\n  \"Helio\",\n  \"Helios\",\n  \"Helle\",\n  \"Hellhound\",\n  \"Hephaestu\",\n  \"Hephaestus\",\n  \"Hera\",\n  \"Hera\",\n  \"Heracles\",\n  \"Hercules\",\n  \"Herme\",\n  \"Hero\",\n  \"heroes\",\n  \"Hesperus\",\n  \"Hesti\",\n  \"Hestia\",\n  \"Hieracosphinx\",\n  \"Hippalectryon\",\n  \"Hippocampus\",\n  \"Hippodamia\",\n  \"Hippolyte\",\n  \"Hippolytus\",\n  \"Hippomenes\",\n  \"Hoopoe\",\n  \"Hyacinthus\",\n  \"Hydra\",\n  \"Hylaeus\",\n  \"Hylonome\",\n  \"Hyperion\",\n  \"Hypno\",\n  \"Hypnos\",\n  \"Iapetus\",\n  \"Icarus\",\n  \"Ichthyocentaurs\",\n  \"Io\",\n  \"Iobates\",\n  \"Ionia\",\n  \"Iphigenia\",\n  \"Ipotane\",\n  \"Iris\",\n  \"Ismene\",\n  \"Ixion\",\n  \"Janus\",\n  \"Jocasta\",\n  \"Juno\",\n  \"Jupiter\",\n  \"Juventas\",\n  \"Keres\",\n  \"Kobaloi\",\n  \"Labour\",\n  \"Ladon\",\n  \"Laelaps\",\n  \"Laestrygonians\",\n  \"Laius\",\n  \"Lamia\",\n  \"Lamiai\",\n  \"Lamos\",\n  \"LaocoÃ¶n\",\n  \"Lapiths\",\n  \"Lares\",\n  \"Lark\",\n  \"Latona\",\n  \"Lavinia\",\n  \"Leda\",\n  \"Lerna\",\n  \"Lernaean Hydra\",\n  \"Let\",\n  \"Lethe\",\n  \"Leto\",\n  \"Lycaon\",\n  \"Lykaia\",\n  \"Maera\",\n  \"Maia\",\n  \"Manes\",\n  \"Manticore\",\n  \"Marsyas\",\n  \"Medea\",\n  \"Medea\",\n  \"Medusa\",\n  \"Megaera\",\n  \"Meleager\",\n  \"Melpomene\",\n  \"Memnon\",\n  \"Menelaus\",\n  \"Menoetes\",\n  \"Menoetius\",\n  \"Mentor\",\n  \"Merope\",\n  \"Midas\",\n  \"Mimas\",\n  \"Minerva\",\n  \"Minos\",\n  \"Minotaur\",\n  \"Mnemosyne\",\n  \"Momus\",\n  \"Monocerata\",\n  \"Mormo\",\n  \"Mormolykeia\",\n  \"Morpheus\",\n  \"Mors\",\n  \"Muse\",\n  \"Muses\",\n  \"Myrmekes\",\n  \"Mysia\",\n  \"Naiads\",\n  \"Napaeae\",\n  \"Narcissus\",\n  \"Nemea\",\n  \"Nemesis\",\n  \"Neoptolemus\",\n  \"nereid\",\n  \"Nessus\",\n  \"Nestor\",\n  \"Nestor\",\n  \"Nike\",\n  \"Niobe\",\n  \"Nomios\",\n  \"Notus\",\n  \"Ny\",\n  \"Nyctimene\",\n  \"Nyctimus\",\n  \"Nymphs\",\n  \"Nyx\",\n  \"Oceanids\",\n  \"Oceanu\",\n  \"Oceanus\",\n  \"Ocypete\",\n  \"Odontotyrannos\",\n  \"Odysseu\",\n  \"Odysseus\",\n  \"Oedipus\",\n  \"Oenoe\",\n  \"Oenone\",\n  \"Onocentaur\",\n  \"Ophiotaurus\",\n  \"Ops\",\n  \"Orestes\",\n  \"Orion\",\n  \"Orpheus\",\n  \"Orthrus\",\n  \"Ouroboros\",\n  \"Pa\",\n  \"Pallas\",\n  \"Pan\",\n  \"Pan\",\n  \"Pandora\",\n  \"Panes\",\n  \"panthers\",\n  \"Parcae\",\n  \"Paris\",\n  \"Parrhasia\",\n  \"PasiphaÃ«\",\n  \"Patroclus\",\n  \"Pegasus\",\n  \"Pegasus\",\n  \"Pelias\",\n  \"Pelops\",\n  \"Penates\",\n  \"Penelope\",\n  \"Periboea\",\n  \"Perimedes\",\n  \"Persephon\",\n  \"Persephone \",\n  \"Perseus\",\n  \"Phaedra\",\n  \"Phaethon\",\n  \"Phaethon\",\n  \"Philoctetes\",\n  \"Philomela\",\n  \"Phineus\",\n  \"Phlegethon\",\n  \"Phoenix\",\n  \"PhÃ³los\",\n  \"Pirithous\",\n  \"Pleiades\",\n  \"Plut\",\n  \"Pollux\",\n  \"Polybotes\",\n  \"Polyhymnia\",\n  \"Polymnia\",\n  \"Polynices\",\n  \"Polyphemus\",\n  \"Polyphemus\",\n  \"Polyxena\",\n  \"Pontus\",\n  \"Porphyrion\",\n  \"Poseido\",\n  \"Poseidon\",\n  \"Priam\",\n  \"Priapus\",\n  \"Procne\",\n  \"Procrustes\",\n  \"Prometheus\",\n  \"Proserpine\",\n  \"Proteus\",\n  \"Psyche\",\n  \"Pygmalion\",\n  \"Pyramus\",\n  \"Python\",\n  \"Quirinus\",\n  \"Rhadamanthus\",\n  \"Rhaecus\",\n  \"Rhe\",\n  \"Rhea\",\n  \"Romulus\",\n  \"Sarpedon\",\n  \"Saturn\",\n  \"Satyresses\",\n  \"Satyrs\",\n  \"Scylla\",\n  \"Selene\",\n  \"Semele\",\n  \"Sileni\",\n  \"Silenus\",\n  \"Silvanus\",\n  \"Siren\",\n  \"Sirens\",\n  \"Sisyphus\",\n  \"Sol\",\n  \"Somnus\",\n  \"Sphinx\",\n  \"Sterop\",\n  \"Stheno\",\n  \"Strix\",\n  \"Styx\",\n  \"Symplegades\",\n  \"Syrinx\",\n  \"Talos\",\n  \"Tantalus\",\n  \"Taras\",\n  \"Taraxippi\",\n  \"Tartarus\",\n  \"Telemachus\",\n  \"Tellus\",\n  \"Tereus\",\n  \"Terminus\",\n  \"Terpsichore\",\n  \"Thalia\",\n  \"Thanato\",\n  \"Thanatos\",\n  \"Thaumas\",\n  \"Themis\",\n  \"Theseus\",\n  \"Thisbe\",\n  \"Thoon\",\n  \"Thrace\",\n  \"Thyestes\",\n  \"Tiresias\",\n  \"Tisiphone\",\n  \"Titans\",\n  \"Tithonus\",\n  \"Tityos\",\n  \"Triton\",\n  \"Trojan\",\n  \"Turnus\",\n  \"Typhon\",\n  \"Ulysses\",\n  \"Urania\",\n  \"Uranus\",\n  \"Venus\",\n  \"Vesta\",\n  \"Virgil\",\n  \"Vulcan\",\n  \"Xanthus\",\n  \"Zephyrus\",\n  \"Zeu\",\n  \"Zeus\",\n];\n","import mt19937 from \"@stdlib/random-base-mt19937\";\n\nconst MAX = 4294967295;\n\nexport class Random {\n  public static getRandom(seed: number[]) {\n    var rand = mt19937.factory({\n      seed: seed,\n    });\n\n    return rand() / MAX;\n  }\n\n  public static getRandomInt(min: number, max: number, seed: number[]) {\n    return Math.floor(Random.getRandom(seed) * (max - min + 1) + min);\n  }\n\n  public static getRandomFloat(min: number, max: number, seed: number[]) {\n    return Random.getRandom(seed) * (max - min) + min;\n  }\n\n  public static coinToss(seed: number[]) {\n    return Random.getRandom(seed) <= 0.5;\n  }\n\n  public static getRandomFromArray(array: any[], seed: number[]) {\n    const index = this.getRandomInt(0, array.length - 1, seed);\n    return array[index];\n  }\n\n  /**\n   * Gets a random point of a sphere, evenly distributed over the sphere.\n   * The sphere is centered at (x0,y0,z0) with the passed in radius.\n   * The returned point is returned as a three element array [x,y,z].\n   *\n   * @return [x,y,z]\n   */\n  public static getRandomPointInSphere(radius: number, x0: number, y0: number, z0: number) {\n    if (!x0) {\n      x0 = 0;\n    }\n    if (!y0) {\n      y0 = 0;\n    }\n    if (!z0) {\n      z0 = 0;\n    }\n\n    var u = Math.random();\n    var v = Math.random();\n    var theta = 2 * Math.PI * u;\n    var phi = Math.acos(1 - 2 * v);\n    var x = x0 + radius * Math.sin(phi) * Math.cos(theta);\n    var y = y0 + radius * Math.sin(phi) * Math.sin(theta);\n    var z = z0 + radius * Math.cos(phi);\n\n    return [x, y, z];\n  }\n}\n","import { SolarSystem, SolarSystemEntity } from \"../models/SolarSystem\";\nimport { planetNames } from \"./planetNames\";\nimport { Random } from \"./Random\";\n\n// some real values from our own solar system to work from\n// distance in km, speeds in km/h\nconst solarSystemValues = {\n  solRadius: 695508,\n\n  earthOrbitSpeed: 110000,\n\n  minPlanetRadius: 2440, // mercury\n  maxPlanetRadius: 69911, // jupiter\n\n  minPlanetOrbitRadius: 59223859, // mercury\n  maxPlanetOrbitRadius: 4498438348, // neptune\n\n  maxPlanetOrbitSpeed: 172331, //mercury\n\n  minMoonOrbitRadius: 384400, // luna\n  maxMoonOrbitRadius: 1882709, // callisto\n\n  maxMoonOrbitSpeed: 62400, // io\n\n  // todo: gas planets spin fast than solid ones, factor this in when\n  // more planet types added\n  minPlanetSpinSpeed: 6.52, // venus\n  maxPlanetSpinSpeed: 45583, //jupiter\n\n  minDistanceBetweenPlanets: 41400000, //earth->venus\n};\n\nconst seedIndexes = {\n  radius: 0,\n  terrainHeight: 1,\n  colour: 2,\n  noiseMap: 3,\n  orbitDirection: 4,\n  orbitSpeed: 5,\n  spinSpeed: 6,\n  numberOfPlanets: 7,\n  orbitRadius: 8,\n  orbitInclanation: 9,\n  spinDirection: 10,\n  orbitStartPosition: 11,\n  planetName: 12,\n};\n\nexport class SolarSystemGenerator {\n  private entityId = 0;\n  private seed: number;\n\n  private solarSystem: SolarSystem = {\n    stars: [],\n    planets: [],\n  };\n\n  constructor(seed: number) {\n    this.seed = seed;\n  }\n\n  private getNextId(): number {\n    this.entityId++;\n    return this.entityId;\n  }\n\n  public generate(starRadius: number = 695508): SolarSystem {\n    const stars: SolarSystemEntity[] = [\n      {\n        id: this.getNextId(),\n        name: `Star ${this.entityId}`,\n        seed: [this.seed, 0],\n        position: [0, 0, 0],\n        radius: starRadius,\n        terrainHeight: 0,\n        moons: [],\n        orbitEntityId: 0,\n        orbitRadius: 0,\n        orbitSpeed: 0,\n        orbitDirection: 0,\n        orbitInclanation: 0,\n        orbitStartPosition: 0,\n        spinSpeed: Random.getRandomFloat(0.0001, 0.0003, [...[this.seed, 0], seedIndexes.spinSpeed]),\n        spinDirection: Random.coinToss([...[this.seed, 0], seedIndexes.spinDirection]) ? 1 : -1,\n      },\n    ];\n\n    for (let starIndex = 0; starIndex < stars.length; starIndex++) {\n      const star = stars[starIndex];\n      const baseSeed = [this.seed, starIndex];\n\n      const numberOfPlanets = Random.getRandomInt(1, 9, [...baseSeed, seedIndexes.numberOfPlanets]);\n\n      // generate random planet orbit radiuses\n      const planetOrbitRadiuses = this.createPlanetOrbitRadiuses(numberOfPlanets, baseSeed);\n\n      for (let planetIndex = 0; planetIndex < numberOfPlanets; planetIndex++) {\n        const baseSeed = [this.seed, starIndex, planetIndex];\n\n        const planetRadius = Random.getRandomInt(\n          solarSystemValues.minPlanetRadius,\n          solarSystemValues.maxPlanetRadius * 2,\n          [...baseSeed, seedIndexes.radius]\n        );\n\n        const planet = this.createPlanet(\n          planetIndex,\n          baseSeed,\n          planetRadius,\n          numberOfPlanets,\n          planetOrbitRadiuses[planetIndex],\n          star\n        );\n\n        // create the moons for the planet\n        const numberOfMoons = Random.getRandomInt(1, 10, [...baseSeed, seedIndexes.numberOfPlanets]);\n\n        // generate random moon orbit radiuses\n        const moonOrbitRadiuses = new Array(numberOfMoons)\n          .fill(null)\n          .map((item, index) =>\n            Random.getRandomInt(solarSystemValues.minMoonOrbitRadius, solarSystemValues.maxMoonOrbitRadius, [\n              ...baseSeed,\n              seedIndexes.orbitRadius,\n              index,\n            ])\n          )\n          .sort((a, b) => a - b);\n\n        for (let moonIndex = 0; moonIndex < numberOfMoons; moonIndex++) {\n          const baseSeed = [this.seed, starIndex, planetIndex, moonIndex];\n\n          const moonRadius = Random.getRandomInt(planetRadius / 12, planetRadius / 3, [\n            ...baseSeed,\n            seedIndexes.radius,\n          ]);\n\n          const moon = this.createMoon(moonIndex, baseSeed, moonRadius, moonOrbitRadiuses[moonIndex], numberOfMoons);\n          planet.moons.push(moon);\n        }\n        // Calculate orbit speeds based on distance from planet\n        for (const moon of planet.moons) {\n          const distanceFromPlanet = moon.orbitRadius;\n          const furthestMoonOrbitRadius = planet.moons[planet.moons.length - 1].orbitRadius;\n          const ratio = 1.5 - distanceFromPlanet / furthestMoonOrbitRadius;\n          moon.orbitSpeed = ratio * solarSystemValues.maxMoonOrbitSpeed;\n        }\n\n        this.solarSystem.planets.push(planet);\n      }\n\n      // Calculate orbit speeds based on distance from star\n      for (const planet of this.solarSystem.planets) {\n        const distanceFromStar = planet.orbitRadius;\n        const furthestPlanetOrbitRadius = this.solarSystem.planets[this.solarSystem.planets.length - 1].orbitRadius;\n        const ratio = 1.5 - distanceFromStar / furthestPlanetOrbitRadius;\n        planet.orbitSpeed = ratio * solarSystemValues.maxPlanetOrbitSpeed;\n      }\n\n      this.solarSystem.stars.push(star);\n    }\n\n    return this.solarSystem;\n  }\n\n  private createPlanetOrbitRadiuses(numberOfPlanets: number, baseSeed: number[]) {\n    const planetOrbitRadiuses = new Array(numberOfPlanets)\n      .fill(null)\n      .map((item, index) =>\n        Random.getRandomInt(solarSystemValues.minPlanetOrbitRadius, solarSystemValues.maxPlanetOrbitRadius, [\n          ...baseSeed,\n          seedIndexes.orbitRadius,\n          index,\n        ])\n      )\n      .sort((a, b) => a - b);\n\n    // Ensure a min distance between planets\n    for (let i = 0; i < planetOrbitRadiuses.length - 1; i++) {\n      const po1 = planetOrbitRadiuses[i];\n      const po2 = planetOrbitRadiuses[i + 1];\n\n      const distanceBetween = po2 - po1;\n\n      if (distanceBetween < solarSystemValues.minDistanceBetweenPlanets) {\n        // if the distance is too small, push all outer planets away by the difference and carry on the loop\n        for (let index = i + 1; index < planetOrbitRadiuses.length; index++) {\n          planetOrbitRadiuses[index] += solarSystemValues.minDistanceBetweenPlanets - distanceBetween;\n        }\n      }\n    }\n\n    return planetOrbitRadiuses;\n  }\n\n  private createMoon(index: number, baseSeed: number[], radius: number, orbitRadius: number, numberOfMoons: number) {\n    const randomOrbitDirection = Random.coinToss([...baseSeed, seedIndexes.orbitDirection]) ? 1 : -1;\n\n    const randomSpinSpeed = Random.getRandomFloat(0.001, 0.005, [...baseSeed, seedIndexes.spinSpeed]);\n\n    const moon: SolarSystemEntity = {\n      id: this.getNextId(),\n      name: `Moon ${index + 1}`,\n      seed: baseSeed,\n      radius: radius,\n      terrainHeight: Random.getRandom([...baseSeed, seedIndexes.terrainHeight]),\n      orbitEntityId: -1,\n      orbitRadius: orbitRadius,\n      orbitDirection: randomOrbitDirection,\n      orbitSpeed: (numberOfMoons - index) / numberOfMoons,\n      orbitInclanation: Random.getRandomInt(0, 45, [...baseSeed, seedIndexes.orbitInclanation]),\n      orbitStartPosition: Random.getRandom([...baseSeed, seedIndexes.orbitStartPosition]),\n      spinSpeed: randomSpinSpeed,\n      spinDirection: Random.coinToss([...baseSeed, seedIndexes.spinDirection]) ? 1 : -1,\n      rgb: getRandomRgb([...baseSeed, seedIndexes.colour]),\n      moons: [],\n    };\n\n    return moon;\n  }\n\n  private createPlanet(\n    index: number,\n    baseSeed: number[],\n    radius: number,\n    numberOfPlanets: number,\n    orbitRadius: number,\n    star: SolarSystemEntity\n  ) {\n    const randomOrbitDirection = Random.coinToss([...baseSeed, seedIndexes.orbitDirection]) ? 1 : -1;\n    const randomSpinSpeed = Random.getRandomFloat(0.002, 0.006, [...baseSeed, seedIndexes.spinSpeed]);\n    const planetName = Random.getRandomFromArray(planetNames, [...baseSeed, seedIndexes.planetName]);\n\n    // create the planet\n    const planet: SolarSystemEntity = {\n      id: this.getNextId(),\n      name: planetName,\n      seed: baseSeed,\n      radius: radius,\n      terrainHeight: 1,\n      orbitEntityId: star.id,\n      orbitRadius: orbitRadius,\n      orbitDirection: randomOrbitDirection,\n      orbitSpeed: (numberOfPlanets - index) / numberOfPlanets,\n      orbitInclanation: Random.getRandomInt(0, 15, [...baseSeed, seedIndexes.orbitInclanation]),\n      orbitStartPosition: Random.getRandom([...baseSeed, seedIndexes.orbitStartPosition]),\n      spinSpeed: randomSpinSpeed,\n      spinDirection: Random.coinToss([...baseSeed, seedIndexes.spinDirection]) ? 1 : -1,\n      moons: [],\n    };\n\n    return planet;\n  }\n}\n\nconst getRandomRgb = (seed: number[]): [number, number, number] => {\n  return [\n    Random.getRandomFloat(0.6, 1, [...seed, 0]),\n    Random.getRandomFloat(0.6, 1, [...seed, 1]),\n    Random.getRandomFloat(0.6, 1, [...seed, 2]),\n  ];\n};\n","import { Entity } from \"./Entity\";\n\nexport class Moon extends Entity {\n  protected maxTerrainHeight = 5;\n\n  protected _dispose(): void {}\n\n  protected getMapColour(height: number, y: number): number[] {\n    const ratio = height / 128;\n\n    const { r, g, b } = this.params.colour!;\n\n    const rgba = [Math.floor(r * 255), Math.floor(g * 255), Math.floor(b * 255), 255];\n\n    return [rgba[0] * ratio, rgba[1] * ratio, rgba[2] * ratio, rgba[3]];\n  }\n}\n","import { Random } from \"../utils/Random\";\nimport { Entity } from \"./Entity\";\n\nexport class ClassM extends Entity {\n  protected maxTerrainHeight = this.radius / 16;\n\n  protected _dispose(): void {}\n\n  private colours = {\n    oceanDark: this.getRandomColour(0),\n    oceanLight: this.getRandomColour(1),\n    beachDark: this.getRandomColour(2),\n    beachLight: this.getRandomColour(3),\n    forestDark: this.getRandomColour(4),\n    forestLight: this.getRandomColour(5),\n    jungleDark: this.getRandomColour(6),\n    jungleLight: this.getRandomColour(7),\n    savannahDark: this.getRandomColour(8),\n    savannahLight: this.getRandomColour(9),\n    desertDark: this.getRandomColour(10),\n    desertLight: this.getRandomColour(11),\n    snowDark: this.getRandomColour(12),\n    snowLight: this.getRandomColour(13),\n  };\n\n  protected getMapColour(height: number, y: number) {\n    const colour = this.getColourForHeight(height);\n    return colour;\n  }\n\n  private getColourForHeight(height: number) {\n    const levels = [\n      // sea\n      {\n        min: 0,\n        max: 60,\n        dark: this.colours.oceanDark,\n        light: this.colours.oceanLight,\n      },\n      // beach\n      {\n        min: 60,\n        max: 70,\n        dark: this.colours.oceanLight,\n        light: this.colours.beachLight,\n      },\n      // forest\n      {\n        min: 70,\n        max: 110,\n        dark: this.colours.forestDark,\n        light: this.colours.forestLight,\n      },\n      // jungle\n      {\n        min: 110,\n        max: 120,\n        dark: this.colours.jungleDark,\n        light: this.colours.jungleLight,\n      },\n      // savannah\n      {\n        min: 120,\n        max: 140,\n        dark: this.colours.savannahDark,\n        light: this.colours.savannahLight,\n      },\n      // desert\n      {\n        min: 120,\n        max: 150,\n        dark: this.colours.desertDark,\n        light: this.colours.desertLight,\n      },\n    ];\n\n    for (const level of levels) {\n      if (height < level.max) {\n        return this.getRangeColour(level, height);\n      }\n    }\n\n    return this.colours.snowLight;\n  }\n\n  private getRandomColour(colIndex: number) {\n    const seed = [...this.params.baseSeed, colIndex];\n\n    const min = 0.2;\n    return [\n      255 * Random.getRandomFloat(min, 1, [...seed, 0]),\n      255 * Random.getRandomFloat(min, 1, [...seed, 1]),\n      255 * Random.getRandomFloat(min, 1, [...seed, 2]),\n      255,\n    ];\n  }\n}\n","import { Entity, EntityParams, EntityType } from \"./Entity\";\n\nexport class Star extends Entity {\n  protected maxTerrainHeight = 0;\n\n  constructor(id: number, name: string, entityType: EntityType, radius: number, params: EntityParams) {\n    super(id, name, entityType, radius, params);\n\n    this.params.terrainHeight = 0;\n    this.params.texturePath = \"assets/sun.jpg\";\n  }\n\n  protected _dispose(): void {}\n\n  protected getMapColour(height: number, y: number): number[] {\n    const { r, g, b } = this.params.colour!;\n    const rgba = [Math.floor(r * 255), Math.floor(g * 255), Math.floor(b * 255), 255];\n    return [rgba[0], rgba[1], rgba[2], rgba[3]];\n  }\n}\n","import { Entity } from \"./Entity\";\n\nconst colours = {\n  oceanDark: [0, 24, 168, 255],\n  oceanLight: [0, 105, 148, 255],\n  beachDark: [140, 129, 95, 255],\n  beachLight: [221, 202, 146, 255],\n  forestDark: [0, 66, 37, 255],\n  forestLight: [0, 127, 72, 255],\n  jungleDark: [48, 102, 79, 255],\n  jungleLight: [57, 122, 94, 255],\n  savannahDark: [136, 155, 105, 255],\n  savannahLight: [165, 189, 126, 255],\n  desertDark: [175, 175, 144, 255],\n  desertLight: [198, 198, 167, 255],\n  snowDark: [200, 200, 200, 255],\n  snowLight: [255, 255, 255, 255],\n};\n\nexport class Earth extends Entity {\n  protected maxTerrainHeight = this.radius / 16;\n\n  protected _dispose(): void {}\n\n  protected getMapColour(height: number, y: number) {\n    const colour = this.getColourForHeight(height);\n\n    // if (y > this.textureHeight * 0.9) {\n    //   return this.lerpColour(colour, colours.snow, y / this.textureHeight);\n    // }\n\n    return colour;\n  }\n\n  private getColourForHeight(height: number) {\n    const levels = [\n      // sea\n      {\n        min: 0,\n        max: 60,\n        dark: colours.oceanDark,\n        light: colours.oceanLight,\n      },\n      // beach\n      {\n        min: 60,\n        max: 70,\n        dark: colours.oceanLight,\n        light: colours.beachLight,\n      },\n      // forest\n      {\n        min: 70,\n        max: 110,\n        dark: colours.forestDark,\n        light: colours.forestLight,\n      },\n      // jungle\n      {\n        min: 110,\n        max: 120,\n        dark: colours.jungleDark,\n        light: colours.jungleLight,\n      },\n      // savannah\n      {\n        min: 120,\n        max: 140,\n        dark: colours.savannahDark,\n        light: colours.savannahLight,\n      },\n      // desert\n      {\n        min: 120,\n        max: 150,\n        dark: colours.desertDark,\n        light: colours.desertLight,\n      },\n    ];\n\n    for (const level of levels) {\n      if (height < level.max) {\n        return this.getRangeColour(level, height);\n      }\n    }\n\n    return colours.snowLight;\n  }\n}\n","import \"normalize.css\";\nimport \"./index.css\";\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport { App } from \"./components/App/App\";\nimport { SolarSystemApp } from \"./app/SolarSystemApp\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App solarSystemApp={new SolarSystemApp()}></App>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n","import {\n  AmbientLight,\n  // AxesHelper,\n  Camera,\n  Clock,\n  Color,\n  CubeTextureLoader,\n  MathUtils,\n  PerspectiveCamera,\n  PointLight,\n  Scene,\n  Texture,\n  Vector3,\n  WebGLRenderer,\n} from \"three\";\nimport cloneDeep from \"lodash/cloneDeep\";\n\nimport { Entity, EntityParams, EntityType } from \"./entities/Entity\";\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\nimport Stats from \"three/examples/jsm/libs/stats.module\";\nimport { GUI } from \"three/examples/jsm/libs/dat.gui.module\";\n\nimport { SolarSystemGenerator } from \"./utils/SolarSystemGenerator\";\n\nimport { Moon } from \"./entities/Moon\";\nimport { ClassM } from \"./entities/ClassM\";\nimport { Star } from \"./entities/Star\";\nimport { Earth } from \"./entities/Earth\";\nimport { SolarSystem, SolarSystemEntity } from \"./models/SolarSystem\";\n\nconst sunColour = 0xf7e096;\n\nexport class SolarSystemApp {\n  private solarSystem!: SolarSystem;\n\n  private isRunning = false;\n  private scene!: Scene;\n  private camera!: Camera;\n  private clock = new Clock();\n  private bodies: Entity[] = [];\n  private renderer!: WebGLRenderer;\n  private orbitControls!: OrbitControls;\n  private stats!: Stats;\n  private showPlanetId!: number;\n  private cameraInitialPosition!: [number, number, number];\n  private spaceTexture!: Texture;\n  private gui!: GUI;\n  private guiViewActionsFolder!: GUI;\n  private guiPlanetsFolder!: GUI;\n  private planetPositionVector = new Vector3();\n\n  private ambientLight!: AmbientLight;\n  private pointLight!: PointLight;\n\n  // events\n  public onInitialising!: () => void;\n  public onInitialised!: () => void;\n  public onSelectPlanet!: (planet?: SolarSystemEntity) => void;\n\n  private options = {\n    seed: 982174,\n    simulationSpeed: 3,\n    showOrbits: true,\n    followPlanetName: \"Star 1\",\n    trueScale: false,\n    showPlanetLabels: false,\n    showStats: true,\n  };\n\n  private buttonHandlers = {\n    resetView: () => {\n      this.resetView();\n    },\n    newSeed: () => {\n      this.options.seed = MathUtils.randInt(100000, 999999);\n      this.init();\n    },\n    changeSeed: () => {\n      this.init();\n    },\n  };\n\n  constructor() {\n    this.solarSystem = new SolarSystemGenerator(this.options.seed).generate();\n\n    this.scene = new Scene();\n    this.scene.background = new Color().setHex(0x000000);\n\n    const loader = new CubeTextureLoader();\n    this.spaceTexture = loader.load([\n      \"assets/kurt/space_ft.png\",\n      \"assets/kurt/space_bk.png\",\n      \"assets/kurt/space_up.png\",\n      \"assets/kurt/space_dn.png\",\n      \"assets/kurt/space_rt.png\",\n      \"assets/kurt/space_lf.png\",\n    ]);\n    this.scene.background = this.spaceTexture;\n\n    // Camera\n    this.camera = new Camera();\n    this.camera = new PerspectiveCamera(25, window.innerWidth / window.innerHeight, 50, 1e10);\n    this.cameraInitialPosition = [0, this.solarSystem.stars[0].radius * 6, this.solarSystem.stars[0].radius * 20];\n    this.camera.position.set(...this.cameraInitialPosition);\n\n    this.camera.lookAt(0, 0, 0);\n\n    // Renderer\n    this.renderer = new WebGLRenderer({\n      powerPreference: \"high-performance\",\n      antialias: true,\n    });\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\n    this.renderer.setPixelRatio(window.devicePixelRatio);\n    this.renderer.shadowMap.enabled = true;\n    document.body.appendChild(this.renderer.domElement);\n\n    // Controls\n    this.orbitControls = new OrbitControls(this.camera, this.renderer.domElement);\n    this.orbitControls.enableDamping = true;\n    this.orbitControls.update();\n\n    // Stats\n    this.stats = new (Stats as any)();\n    document.body.appendChild(this.stats.dom);\n\n    // UI\n    this.gui = new GUI();\n    this.gui.width = 300;\n\n    this.gui.add(this.buttonHandlers, \"newSeed\").name(\"New Seed\");\n    this.gui.add(this.options, \"seed\").name(\"Seed\").onFinishChange(this.buttonHandlers.changeSeed);\n    this.gui.add(this.options, \"simulationSpeed\", 0, 20, 0.1).name(\"Simulation Speed\");\n  }\n\n  public init = () => {\n    if (this.onInitialising) {\n      this.onInitialising();\n    }\n\n    this.gui.updateDisplay();\n    this.clearScene();\n    this.solarSystem = new SolarSystemGenerator(this.options.seed).generate();\n\n    // default to showing labels when in true scale (and vice-versa)\n    this.options.showPlanetLabels = this.options.trueScale;\n\n    this._init().then(() => {\n      this.resetView();\n      this.animate();\n      if (this.onInitialised) {\n        this.onInitialised();\n      }\n    });\n  };\n\n  private _init = async () => {\n    this.showPlanetId = -1;\n\n    // var axesHelper = new AxesHelper(5000);\n    // scene.add(axesHelper);\n\n    // Lighting\n    this.ambientLight = new AmbientLight(0xffffff, 0.15);\n    this.scene.add(this.ambientLight);\n\n    this.pointLight = new PointLight(sunColour, 1);\n    this.pointLight.position.set(0, 0, 0);\n    this.scene.add(this.pointLight);\n\n    if (this.options.trueScale) {\n      await this.renderRealisticSolarSystem();\n      this.camera.position.set(...this.cameraInitialPosition);\n    } else {\n      await this.renderSolarSystem();\n      this.camera.position.set(...this.cameraInitialPosition).divideScalar(500);\n    }\n\n    const planets = this.bodies.filter((b) => b.entityType === EntityType.Planet);\n    const star = this.bodies.filter((b) => b.entityType === EntityType.Star)[0];\n\n    this.guiViewActionsFolder = this.gui.addFolder(\"View Options\");\n    this.guiViewActionsFolder.open();\n\n    this.guiViewActionsFolder\n      .add(this.options, \"followPlanetName\", [star.name, ...planets.map((p) => p.name)])\n      .name(\"Centre of View\")\n      .onChange(this.onFollowPlanetNameChange);\n    this.guiViewActionsFolder.add(this.buttonHandlers, \"resetView\").name(\"Reset View\");\n\n    this.guiViewActionsFolder.add(this.options, \"trueScale\").name(\"True Scale\").onChange(this.init);\n    this.guiViewActionsFolder.add(this.options, \"showOrbits\").name(\"Orbits\").onChange(this.toggleOrbits);\n    this.guiViewActionsFolder.add(this.options, \"showPlanetLabels\").name(\"Labels\");\n    this.guiViewActionsFolder.add(this.options, \"showStats\").name(\"Stats\");\n\n    this.guiPlanetsFolder = this.gui.addFolder(\"Planets\");\n    for (let index = 0; index < planets.length; index++) {\n      const planet = planets[index];\n      this.guiPlanetsFolder.add(planet, \"show\").name(`#${index + 1}: ${planet.name}`);\n    }\n\n    this.isRunning = true;\n  };\n\n  public animate = () => {\n    if (!this.isRunning) {\n      return;\n    }\n    requestAnimationFrame(this.animate);\n\n    this.bodies.forEach((body) => {\n      body.animate(\n        this.clock,\n        this.options.simulationSpeed / 2,\n        this.camera,\n        this.options.showPlanetLabels && this.showPlanetId === -1\n      );\n    });\n\n    if (this.options.showStats) {\n      this.stats.dom.style.display = \"initial\";\n      this.stats.update();\n    } else {\n      this.stats.dom.style.display = \"none\";\n    }\n\n    if (this.showPlanetId > -1) {\n      const planet = this.bodies.find((b) => b.id === this.showPlanetId);\n      if (planet) {\n        planet.sphere.getWorldPosition(this.planetPositionVector);\n        const { x, y, z } = this.planetPositionVector;\n        this.camera.position.set(x + planet.radius * 2, y + planet.radius * 2, z + planet.radius * 10);\n        this.camera.lookAt(x, y, z);\n      }\n    } else {\n      if (this.options.followPlanetName !== \"Star 1\") {\n        const planet = this.bodies.find((b) => b.name === this.options.followPlanetName);\n        if (planet) {\n          planet.sphere.getWorldPosition(this.planetPositionVector);\n          const { x, y, z } = this.planetPositionVector;\n          this.orbitControls.target.set(x, y, z);\n          this.orbitControls.update();\n        }\n      }\n    }\n\n    this.renderer.render(this.scene, this.camera);\n  };\n\n  private clearScene = () => {\n    this.isRunning = false;\n\n    try {\n      this.gui.removeFolder(this.guiViewActionsFolder);\n      this.gui.removeFolder(this.guiPlanetsFolder);\n      this.guiViewActionsFolder.destroy();\n    } catch (error) {}\n\n    this.ambientLight?.dispose();\n    this.pointLight?.dispose();\n\n    for (const body of this.bodies) {\n      body.dispose();\n    }\n    this.bodies = [];\n    this.scene.clear();\n\n    this.renderer.render(this.scene, this.camera);\n  };\n\n  private resetView = () => {\n    this.showPlanetId = -1;\n\n    if (this.options.trueScale) {\n      this.camera.position.set(...this.cameraInitialPosition);\n    } else {\n      this.camera.position.set(...this.cameraInitialPosition).divideScalar(500);\n    }\n\n    if (this.onSelectPlanet) {\n      this.onSelectPlanet(undefined);\n    }\n  };\n\n  private handleShowPlanet = (id: number) => {\n    this.showPlanetId = id;\n\n    if (this.onSelectPlanet) {\n      const planet = this.solarSystem.planets.find((p) => p.id === id) as SolarSystemEntity;\n      this.onSelectPlanet(planet);\n    }\n  };\n\n  private toggleOrbits = () => {\n    for (const body of this.bodies) {\n      if (body.orbit) {\n        body.orbit.opacity = body.orbit.opacity === 0 ? 0.5 : 0;\n      }\n    }\n  };\n\n  /**\n   * Might have to rework this if multi-star systems are added\n   * but for now it saves updating the orbit controls each render frame if we're just looking at the star\n   */\n  private onFollowPlanetNameChange = () => {\n    if (this.options.followPlanetName === \"Star 1\") {\n      this.orbitControls.target.set(0, 0, 0);\n      this.orbitControls.update();\n    }\n  };\n\n  /**\n   * Renders a 1000th scale model of the solar system\n   */\n  private renderRealisticSolarSystem = async () => {\n    // scale radiuses and speeds down to displayable proportions\n    const viewScale = 1 / 1000;\n\n    for (const star of this.solarSystem.stars) {\n      const radius = star.radius * viewScale;\n      const orbitRadius = star.orbitRadius * viewScale;\n      const orbitSpeed = star.orbitSpeed * viewScale;\n\n      const starEntity = new Star(star.id, star.name, EntityType.Star, radius, {\n        baseSeed: star.seed,\n        position: star.position ? new Vector3(...star.position) : new Vector3(0, 0, 0),\n        colour: new Color(0xffca20),\n        orbitEntity: false,\n        orbitRadius: orbitRadius,\n        orbitDirection: star.orbitDirection,\n        orbitSpeed: orbitSpeed,\n        orbitInclanation: star.orbitInclanation,\n        orbitStartPosition: star.orbitStartPosition,\n        spinSpeed: star.spinSpeed,\n        spinDirection: star.spinDirection,\n      });\n      await starEntity.create();\n      this.bodies.push(starEntity);\n      this.scene.add(starEntity.entity);\n\n      for (let planetIndex = 0; planetIndex < this.solarSystem.planets.length; planetIndex++) {\n        const planet = this.solarSystem.planets[planetIndex];\n\n        const radius = planet.radius * viewScale;\n        const orbitRadius = planet.orbitRadius * viewScale;\n        const orbitSpeed = planet.orbitSpeed * viewScale;\n\n        const orbitEntity = this.bodies.find((b) => b.id === planet.orbitEntityId) as Entity;\n\n        const planetParams: EntityParams = {\n          baseSeed: planet.seed,\n          position: planet.position ? new Vector3(...planet.position) : orbitEntity.entity.position,\n          terrainHeight: planet.terrainHeight,\n          orbitEntity: orbitEntity,\n          orbitRadius: orbitRadius,\n          orbitDirection: planet.orbitDirection,\n          orbitSpeed: orbitSpeed,\n          orbitInclanation: planet.orbitInclanation,\n          orbitStartPosition: planet.orbitStartPosition,\n          spinSpeed: planet.spinSpeed,\n          spinDirection: planet.spinDirection,\n          hasLabel: true,\n          onShow: this.handleShowPlanet,\n        };\n\n        const planetEntity =\n          planetIndex === 2\n            ? new Earth(planet.id, planet.name, EntityType.Planet, radius, planetParams)\n            : new ClassM(planet.id, planet.name, EntityType.Planet, radius, planetParams);\n        await planetEntity.create();\n\n        for (const moon of planet.moons) {\n          const radius = moon.radius * viewScale;\n          const orbitRadius = moon.orbitRadius * viewScale;\n          const orbitSpeed = moon.orbitSpeed * viewScale;\n\n          const orbitEntity = planetEntity;\n\n          const moonEntity = new Moon(moon.id, moon.name, EntityType.Moon, radius, {\n            baseSeed: moon.seed,\n            position: moon.position ? new Vector3(...moon.position) : orbitEntity.entity.position,\n            colour: moon.rgb ? new Color(...moon.rgb) : new Color(1, 1, 1),\n            terrainHeight: moon.terrainHeight,\n            orbitEntity: orbitEntity,\n            orbitRadius: orbitRadius,\n            orbitDirection: moon.orbitDirection,\n            orbitSpeed: orbitSpeed,\n            orbitInclanation: moon.orbitInclanation,\n            orbitStartPosition: moon.orbitStartPosition,\n            spinSpeed: moon.spinSpeed,\n            spinDirection: planet.spinDirection,\n          });\n          await moonEntity.create();\n          this.bodies.push(moonEntity);\n          // add the moon to the planet (so it follows the planet's orbit)\n          planetEntity.entity.add(moonEntity.entity);\n        }\n\n        this.bodies.push(planetEntity);\n        this.scene.add(planetEntity.entity);\n      }\n    }\n  };\n\n  /**\n   * Renders a view friendly, compressed version of the solar system\n   */\n  private renderSolarSystem = async () => {\n    // scale radiuses and speeds down to displayable proportions\n    const viewScale = 1 / 1000;\n\n    for (const star of this.solarSystem.stars) {\n      const starRadius = star.radius * viewScale * 4;\n      const orbitRadius = star.orbitRadius * viewScale;\n      const orbitSpeed = star.orbitSpeed * viewScale;\n\n      const starEntity = new Star(star.id, star.name, EntityType.Star, starRadius, {\n        baseSeed: star.seed,\n        position: star.position ? new Vector3(...star.position) : new Vector3(0, 0, 0),\n        colour: new Color(0xffca20),\n        orbitEntity: false,\n        orbitRadius: orbitRadius,\n        orbitDirection: star.orbitDirection,\n        orbitSpeed: orbitSpeed,\n        orbitInclanation: star.orbitInclanation,\n        orbitStartPosition: star.orbitStartPosition,\n        spinSpeed: star.spinSpeed,\n        spinDirection: star.spinDirection,\n      });\n      await starEntity.create();\n      this.bodies.push(starEntity);\n      this.scene.add(starEntity.entity);\n\n      const planets = cloneDeep(this.solarSystem.planets);\n\n      // increase the radiuses (and moons to match)\n      for (const planet of planets) {\n        const scale = 4;\n        planet.radius *= scale;\n        for (const moon of planet.moons) {\n          moon.radius *= scale;\n          moon.orbitSpeed *= scale;\n        }\n      }\n\n      // compress the orbits\n      for (let i = 0; i < planets.length; i++) {\n        const planet = planets[i];\n        const planetMoonRadius = planet.moons[planet.moons.length - 1].orbitRadius;\n\n        if (i === 0) {\n          planet.orbitRadius = star.radius * 2 + planetMoonRadius * 2;\n        } else {\n          const prevPlanet = planets[i - 1];\n          const prevPlanetMoonRadius = prevPlanet.moons[prevPlanet.moons.length - 1].orbitRadius;\n          planet.orbitRadius = prevPlanet.orbitRadius + prevPlanetMoonRadius + planetMoonRadius;\n\n          // Extend the orbit slightly based on the actual orbit sizes\n          const r =\n            (this.solarSystem.planets[i].orbitRadius - this.solarSystem.planets[i - 1].orbitRadius) /\n            this.solarSystem.planets[this.solarSystem.planets.length - 1].orbitRadius;\n\n          planet.orbitRadius += r * planet.orbitRadius * 0.5;\n        }\n      }\n\n      for (let planetIndex = 0; planetIndex < planets.length; planetIndex++) {\n        const planet = planets[planetIndex];\n\n        const radius = planet.radius * viewScale;\n        const orbitRadius = planet.orbitRadius * viewScale;\n        const orbitSpeed = planet.orbitSpeed * viewScale;\n\n        const orbitEntity = this.bodies.find((b) => b.id === planet.orbitEntityId) as Entity;\n\n        const planetParams: EntityParams = {\n          baseSeed: planet.seed,\n          position: planet.position ? new Vector3(...planet.position) : orbitEntity.entity.position,\n          terrainHeight: planet.terrainHeight,\n          orbitEntity: orbitEntity,\n          orbitRadius: orbitRadius,\n          orbitDirection: planet.orbitDirection,\n          orbitSpeed: orbitSpeed,\n          orbitInclanation: planet.orbitInclanation,\n          orbitStartPosition: planet.orbitStartPosition,\n          spinSpeed: planet.spinSpeed,\n          spinDirection: planet.spinDirection,\n          hasLabel: true,\n          onShow: this.handleShowPlanet,\n        };\n\n        const planetEntity =\n          planetIndex === 2\n            ? new Earth(planet.id, planet.name, EntityType.Planet, radius, planetParams)\n            : new ClassM(planet.id, planet.name, EntityType.Planet, radius, planetParams);\n        await planetEntity.create();\n\n        for (const moon of planet.moons) {\n          const radius = moon.radius * viewScale;\n          const orbitRadius = moon.orbitRadius * viewScale;\n          const orbitSpeed = moon.orbitSpeed * viewScale * 4; // 4 = fudge factor to get moons moving\n          const orbitEntity = planetEntity;\n\n          const moonEntity = new Moon(moon.id, moon.name, EntityType.Moon, radius, {\n            baseSeed: moon.seed,\n            position: moon.position ? new Vector3(...moon.position) : orbitEntity.entity.position,\n            colour: moon.rgb ? new Color(...moon.rgb) : new Color(1, 1, 1),\n            terrainHeight: moon.terrainHeight,\n            orbitEntity: orbitEntity,\n            orbitRadius: orbitRadius,\n            orbitDirection: moon.orbitDirection,\n            orbitSpeed: orbitSpeed,\n            orbitInclanation: moon.orbitInclanation,\n            orbitStartPosition: moon.orbitStartPosition,\n            spinSpeed: moon.spinSpeed,\n            spinDirection: planet.spinDirection,\n          });\n          await moonEntity.create();\n          this.bodies.push(moonEntity);\n          // add the moon to the planet (so it follows the planet's orbit)\n          planetEntity.entity.add(moonEntity.entity);\n        }\n\n        this.bodies.push(planetEntity);\n        this.scene.add(planetEntity.entity);\n      }\n    }\n  };\n}\n"],"sourceRoot":""}