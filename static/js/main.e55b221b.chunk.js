(this.webpackJsonptrees=this.webpackJsonptrees||[]).push([[0],{228:function(t,e,a){"use strict";a.r(e);a(65);var n,i=a(16),r=a(6),o=a.n(r),s=a(12),c=a(7),u=a(10),h=a(5),d=a(0),l=a(1),p=a(61),g=function(){function t(e){Object(d.a)(this,t),this.noiseGenerator=void 0,this.noiseGenerator=new p.a(e)}return Object(l.a)(t,[{key:"generateNoiseMap",value:function(t,e){for(var a=[],n=0;n<t;n++){a[n]=[];for(var i=0;i<e;i++){var r=this.getMixedFrequencyNoise(n,i,[.01,.02,.04,.08,.16,.32,.64,1.28]);r=Math.pow(r,2.3),a[n][i]=r}}return this.makeSeamlessVertically(a,.2*e),this.makeSeamlessHorizontally(a,.05*t),a}},{key:"getNoise",value:function(t,e,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=a*t+n,o=a*e+i,s=1/a,c=this.noiseGenerator.noise2D(r,o)/2+.5,u=s*c;return u}},{key:"getMixedFrequencyNoise",value:function(t,e,a){var n=this,i=0;return a.reduce((function(a,r,o){i+=1/r;var s=10*o,c=100*o;return a+n.getNoise(t,e,r,s,c)}),0)/i}},{key:"makeSeamlessHorizontally",value:function(t,e){for(var a=t.length,n=t[0].length,i=0;i<e;i++)for(var r=i/e,o=0;o<n;o++){var s=~~(a-e+i);t[s][o]=h.t.lerp(t[s][o],t[~~(e-i)][o],r)}}},{key:"makeSeamlessVertically",value:function(t,e){for(var a=t.length,n=t[0].length,i=0;i<e;i++)for(var r=Math.ceil(e-i),o=0;o<a;o++){for(var s=0,c=0,u=0,h=o-r;h<o+r;h++)h<0||h>=a||(s+=t[h][i],c+=t[h][n-i-1],u++);t[o][i]=s/u,t[o][n-i-1]=c/u}}}]),t}();!function(t){t[t.Sun=0]="Sun",t[t.Planet=1]="Planet",t[t.Moon=2]="Moon"}(n||(n={}));var m=function(){function t(e,a,n,i){Object(d.a)(this,t),this.id=void 0,this.entityType=void 0,this.entity=void 0,this.params=void 0,this.radius=void 0,this.sphere=void 0,this.orbit=void 0,this.loader=new h.F,this.textureWidth=void 0,this.textureHeight=void 0,this.id=e,this.entityType=a,this.radius=n,this.params=i,this.entity=new h.n,this.textureWidth=512,this.textureHeight=256}return Object(l.a)(t,[{key:"create",value:function(){var t=Object(u.a)(o.a.mark((function t(){var e,a,n,i,r,s,c,u,d;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.params.terrainHeight>0)){t.next=9;break}a=this.generateTerrainMaps(),n=new h.f(a.heightMap.canvas),i=new h.f(a.map.canvas),n.mapping=h.l,i.mapping=h.l,e=new h.w({bumpMap:n,bumpScale:this.params.terrainHeight,map:i,displacementMap:n,displacementScale:this.params.terrainHeight}),t.next=17;break;case 9:if(!this.params.texturePath){t.next=16;break}return t.next=12,this.loader.loadAsync(this.params.texturePath);case 12:r=t.sent,e=new h.v({map:r,color:this.params.colour}),t.next=17;break;case 16:e=new h.v({color:this.params.colour});case 17:return s=new h.C(this.radius,64,48),this.sphere=new h.u(s,e),this.sphere.castShadow=!!this.params.castShadow,this.sphere.receiveShadow=!!this.params.receiveShadow,this.params.orbitEntity&&(c=this.params.orbitEntity.sphere.position,u=this.params.orbitRadius||400,d=this.createOrbitCircle(u),this.entity.add(d),this.sphere.position.set(u,0,0),this.entity.position.set(c.x,c.y,c.z)),this.entity.add(this.sphere),t.abrupt("return",this);case 24:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"animate",value:function(t){if(t.getElapsedTime(),this.params.orbitEntity){var e=this.params.orbitSpeed,a=this.params.orbitDirection;this.entity.rotation.y+=e*a}this.params.spinSpeed&&(this.sphere.rotation.y+=this.params.spinSpeed)}},{key:"show",value:function(){this.params.onShow&&this.params.onShow(this.id)}},{key:"generateTerrainMaps",value:function(){for(var t=this.getCanvasContext(),e=t.createImageData(this.textureWidth,this.textureHeight),a=e.data,n=this.getCanvasContext(),i=n.createImageData(this.textureWidth,this.textureHeight),r=i.data,o=[].concat(Object(c.a)(this.params.baseSeed),[99999]).reduce((function(t,e){return t+e})),s=new g(o).generateNoiseMap(this.textureWidth,this.textureHeight),u=0;u<a.length;u+=4){for(var h=u/4%this.textureWidth,d=~~(u/4/this.textureWidth),l=255*s[h][d],p=[l,l,l,255],m=0;m<p.length;m++)a[u+m]=p[m];for(var f=this.getMapColour(l,d),b=0;b<f.length;b++)r[u+b]=f[b]}return t.putImageData(e,0,0),n.putImageData(i,0,0),{heightMap:t,map:n}}},{key:"getRangeColour",value:function(t,e){return this.lerpColour(t.dark,t.light,(e-t.min)/(t.max-t.min))}},{key:"lerpColour",value:function(t,e,a){var n=this.convertToColor(t).lerp(this.convertToColor(e),a);return[].concat(Object(c.a)(n.toArray()),[255])}},{key:"convertToColor",value:function(t){return(new h.h).setRGB(t[0],t[1],t[2])}},{key:"getCanvasContext",value:function(){var t=document.createElement("canvas").getContext("2d");return t.canvas.width=this.textureWidth,t.canvas.height=this.textureHeight,t.fillStyle="#fff",t.fillRect(0,0,t.canvas.width,t.canvas.height),t}},{key:"createOrbitCircle",value:function(t){var e=new h.c,a=[];this.orbit=new h.r({color:16777215,opacity:.5,transparent:!0});for(var n=0;n<=128;n++){var i=n/128*Math.PI*2;a.push(Math.cos(i)*t,0,Math.sin(i)*t)}var r=new Float32Array(a);return e.setAttribute("position",new h.b(r,3)),new h.q(e,this.orbit)}}]),t}(),f=a(30),b=a(62),v=a(63),y=a(64),k=a.n(y),w=function(){function t(){Object(d.a)(this,t)}return Object(l.a)(t,null,[{key:"getRandom",value:function(t){return k.a.factory({seed:t})()/4294967295}},{key:"getRandomInt",value:function(e,a,n){return Math.floor(t.getRandom(n)*(a-e+1)+e)}},{key:"getRandomFloat",value:function(e,a,n){return t.getRandom(n)*(a-e)+e}},{key:"coinToss",value:function(e){return t.getRandom(e)<=.5}},{key:"getRandomPointInSphere",value:function(t,e,a,n){e||(e=0),a||(a=0),n||(n=0);var i=Math.random(),r=Math.random(),o=2*Math.PI*i,s=Math.acos(1-2*r);return[e+t*Math.sin(s)*Math.cos(o),a+t*Math.sin(s)*Math.sin(o),n+t*Math.cos(s)]}}]),t}(),x=0,R=1,j=2,O=4,S=5,C=6,M=7,D=8,H=function(){function t(){Object(d.a)(this,t),this.EntityId=0}return Object(l.a)(t,[{key:"getNextId",value:function(){return this.EntityId++,this.EntityId}},{key:"generate",value:function(t){for(var e={suns:[],planets:[]},a=[{id:this.getNextId(),name:"Sun ".concat(this.EntityId),seed:[t,0],position:[0,0,0],radius:1280,terrainHeight:0,moons:[],orbitEntityId:0,orbitRadius:0,orbitSpeed:0,orbitDirection:0,spinSpeed:w.getRandomFloat(1e-4,3e-4,[t,0].concat([C]))}],n=0;n<a.length;n++){for(var i=a[n],r=w.getRandomInt(1,9,[t,n,M]),o=0;o<r;o++){for(var s=[t,n,o],c=w.getRandomInt(.1*i.radius,.3*i.radius,[].concat(s,[x])),u=w.getRandomInt(1,5,[].concat(s,[M])),h=[],d=0;d<u;d++){var l=[t,n,o,d],p=w.coinToss([].concat(l,[O]))?1:-1,g=w.getRandomFloat(.001,.005,[].concat(l,[S])),m=w.getRandomFloat(.001,.005,[].concat(l,[C])),f=w.getRandomInt(3*c*.5,4*c,[].concat(l,[D,0])),b={id:this.getNextId(),name:"Moon ".concat(d),seed:l,radius:w.getRandomInt(c/24,c/8,[].concat(l,[x])),terrainHeight:w.getRandomInt(1,10,[].concat(l,[R])),orbitEntityId:-1,orbitRadius:0===d?f:h[d-1].orbitRadius+w.getRandomInt(.2*f,f,[].concat(l,[D,1])),orbitDirection:p,orbitSpeed:g,spinSpeed:m,rgb:L([].concat(l,[j])),moons:[]};h.push(b)}var v=w.coinToss([].concat(s,[O]))?1:-1,y=w.getRandomFloat(.001,.005,[].concat(s,[S])),k=w.getRandomFloat(.002,.006,[].concat(s,[C])),H=w.getRandomInt(1.1*h[h.length-1].orbitRadius,2*h[h.length-1].orbitRadius,[].concat(s,[D,0])),I=e.planets.length>0?e.planets[e.planets.length-1]:void 0,F=0===o?H:I.orbitRadius,E=0===o?0:I.moons[I.moons.length-1].orbitRadius,P=h[h.length-1].orbitRadius,T=c,W={id:this.getNextId(),name:"Planet ".concat(o),seed:s,radius:c,terrainHeight:8,orbitEntityId:i.id,orbitRadius:F+E+P+T,orbitDirection:v,orbitSpeed:y,spinSpeed:k,moons:h};e.planets.push(W)}e.suns.push(i)}return e}}]),t}(),L=function(t){return[w.getRandomFloat(.6,1,[].concat(Object(c.a)(t),[0])),w.getRandomFloat(.6,1,[].concat(Object(c.a)(t),[1])),w.getRandomFloat(.6,1,[].concat(Object(c.a)(t),[2]))]},I=function(t,e){var a=F(new h.y,t,e);if(e.showHelper){var n=new h.z(a,10);t.add(n)}};function F(t,e,a){var n=a.colour,i=a.intensity,r=a.position,o=a.castShadow;return t.color.set(n),t.intensity=i,t.position.set(r.x,r.y,r.z),t.position.multiplyScalar(30),e.add(t),t.castShadow=!!o,t}var E,P,T,W,A,N,z,V=a(2),_=a(3),q=function(t){Object(V.a)(a,t);var e=Object(_.a)(a);function a(){return Object(d.a)(this,a),e.apply(this,arguments)}return Object(l.a)(a,[{key:"getMapColour",value:function(t,e){var a=t/255,n=this.params.colour,i=n.r,r=n.g,o=n.b,s=[Math.floor(255*i),Math.floor(255*r),Math.floor(255*o),255];return[s[0]*a,s[1]*a,s[2]*a,s[3]]}}]),a}(m),G=function(t){Object(V.a)(a,t);var e=Object(_.a)(a);function a(){var t;Object(d.a)(this,a);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))).colours={oceanDark:t.getRandomColour(0),oceanLight:t.getRandomColour(1),beachDark:t.getRandomColour(2),beachLight:t.getRandomColour(3),forestDark:t.getRandomColour(4),forestLight:t.getRandomColour(5),jungleDark:t.getRandomColour(6),jungleLight:t.getRandomColour(7),savannahDark:t.getRandomColour(8),savannahLight:t.getRandomColour(9),desertDark:t.getRandomColour(10),desertLight:t.getRandomColour(11),snowDark:t.getRandomColour(12),snowLight:t.getRandomColour(13)},t}return Object(l.a)(a,[{key:"getMapColour",value:function(t,e){return this.getColourForHeight(t)}},{key:"getColourForHeight",value:function(t){for(var e=0,a=[{min:0,max:60,dark:this.colours.oceanDark,light:this.colours.oceanLight},{min:60,max:70,dark:this.colours.oceanLight,light:this.colours.beachLight},{min:70,max:110,dark:this.colours.forestDark,light:this.colours.forestLight},{min:110,max:120,dark:this.colours.jungleDark,light:this.colours.jungleLight},{min:120,max:140,dark:this.colours.savannahDark,light:this.colours.savannahLight},{min:120,max:150,dark:this.colours.desertDark,light:this.colours.desertLight}];e<a.length;e++){var n=a[e];if(t<n.max)return this.getRangeColour(n,t)}return this.colours.snowLight}},{key:"getRandomColour",value:function(t){var e=[].concat(Object(c.a)(this.params.baseSeed),[t]);return[255*w.getRandomFloat(.2,1,[].concat(Object(c.a)(e),[0])),255*w.getRandomFloat(.2,1,[].concat(Object(c.a)(e),[1])),255*w.getRandomFloat(.2,1,[].concat(Object(c.a)(e),[2])),255]}}]),a}(m),B=function(t){Object(V.a)(a,t);var e=Object(_.a)(a);function a(){return Object(d.a)(this,a),e.apply(this,arguments)}return Object(l.a)(a,[{key:"getMapColour",value:function(t,e){var a=this.params.colour,n=a.r,i=a.g,r=a.b,o=[Math.floor(255*n),Math.floor(255*i),Math.floor(255*r),255];return[o[0],o[1],o[2],o[3]]}}]),a}(m),J={oceanDark:[0,24,168,255],oceanLight:[0,105,148,255],beachDark:[140,129,95,255],beachLight:[221,202,146,255],forestDark:[0,66,37,255],forestLight:[0,127,72,255],jungleDark:[48,102,79,255],jungleLight:[57,122,94,255],savannahDark:[136,155,105,255],savannahLight:[165,189,126,255],desertDark:[175,175,144,255],desertLight:[198,198,167,255],snowDark:[200,200,200,255],snowLight:[255,255,255,255]},Y=function(t){Object(V.a)(a,t);var e=Object(_.a)(a);function a(){return Object(d.a)(this,a),e.apply(this,arguments)}return Object(l.a)(a,[{key:"getMapColour",value:function(t,e){return this.getColourForHeight(t)}},{key:"getColourForHeight",value:function(t){for(var e=0,a=[{min:0,max:60,dark:J.oceanDark,light:J.oceanLight},{min:60,max:70,dark:J.oceanLight,light:J.beachLight},{min:70,max:110,dark:J.forestDark,light:J.forestLight},{min:110,max:120,dark:J.jungleDark,light:J.jungleLight},{min:120,max:140,dark:J.savannahDark,light:J.savannahLight},{min:120,max:150,dark:J.desertDark,light:J.desertLight}];e<a.length;e++){var n=a[e];if(t<n.max)return this.getRangeColour(n,t)}return J.snowLight}}]),a}(m),K=new h.g,Q=[],U=-1,X=function(){var t=Object(u.a)(o.a.mark((function t(){var e,a,i,r,u,d,l,p,g;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return E=(new H).generate(2),(P=new h.B).background=(new h.h).setHex(0),a=new h.i,i=a.load(["assets/kurt/space_ft.png","assets/kurt/space_bk.png","assets/kurt/space_up.png","assets/kurt/space_dn.png","assets/kurt/space_rt.png","assets/kurt/space_lf.png"]),P.background=i,(W=new h.I({powerPreference:"high-performance",antialias:!0})).setSize(window.innerWidth,window.innerHeight),W.setPixelRatio(window.devicePixelRatio),W.shadowMap.enabled=!0,document.body.appendChild(W.domElement),T=new h.d,T=new h.x(25,window.innerWidth/window.innerHeight,50,1e7),z=[0,6*E.suns[0].radius,20*E.suns[0].radius],(e=T.position).set.apply(e,Object(c.a)(z)),T.lookAt(0,0,0),A=new f.a(T,W.domElement),N=new b.a,document.body.appendChild(N.dom),P.add(new h.a(16777215,.15)),I(P,{colour:16244886,intensity:1,position:new h.H(0,0,0)}),t.next=23,Z();case 23:r=new v.a,u={resetView:function(){var t;U=-1,(t=T.position).set.apply(t,Object(c.a)(z)),A=new f.a(T,W.domElement)},toggleOrbits:function(){var t,e=Object(s.a)(Q);try{for(e.s();!(t=e.n()).done;){var a=t.value;a.orbit&&(a.orbit.opacity=0===a.orbit.opacity?.5:0)}}catch(n){e.e(n)}finally{e.f()}}},(d=r.addFolder("View Actions")).open(),d.add(u,"toggleOrbits").name("Toggle Orbits"),d.add(u,"resetView").name("Reset View"),l=Object(s.a)(Q.filter((function(t){return t.entityType===n.Planet})));try{for(g=function(){var t=p.value,e=E.planets.find((function(e){return e.id===t.id}));d.add(t,"show").name((null===e||void 0===e?void 0:e.name)||"A Planet")},l.s();!(p=l.n()).done;)g()}catch(o){l.e(o)}finally{l.f()}case 31:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Z=function(){var t=Object(u.a)(o.a.mark((function t(){var e,a,r,u,d,l,p;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=function(t){U=t},a=Object(s.a)(E.suns),t.prev=2,a.s();case 4:if((r=a.n()).done){t.next=20;break}return u=r.value,d=new B(u.id,n.Sun,u.radius,{baseSeed:u.seed,position:u.position?Object(i.a)(h.H,Object(c.a)(u.position)):new h.H(0,0,0),colour:new h.h(16763424),terrainHeight:0,texturePath:"assets/sun.jpg",orbitEntity:!1,orbitRadius:u.orbitRadius,orbitDirection:u.orbitDirection,orbitSpeed:u.orbitSpeed,spinSpeed:u.spinSpeed}),t.next=9,d.create();case 9:Q.push(d),P.add(d.entity),l=o.a.mark((function t(a){var r,u,d,l,p,g,m,f,b;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=E.planets[a],u=Q.find((function(t){return t.id===r.orbitEntityId})),d={baseSeed:r.seed,position:r.position?Object(i.a)(h.H,Object(c.a)(r.position)):u.entity.position,terrainHeight:r.terrainHeight,orbitEntity:u,orbitRadius:r.orbitRadius,orbitDirection:r.orbitDirection,orbitSpeed:r.orbitSpeed,spinSpeed:r.spinSpeed,onShow:e},l=2===a?new Y(r.id,n.Planet,r.radius,d):new G(r.id,n.Planet,r.radius,d),t.next=6,l.create();case 6:p=Object(s.a)(r.moons),t.prev=7,p.s();case 9:if((g=p.n()).done){t.next=19;break}return m=g.value,f=l,b=new q(m.id,n.Moon,m.radius,{baseSeed:m.seed,position:m.position?Object(i.a)(h.H,Object(c.a)(m.position)):f.entity.position,colour:m.rgb?Object(i.a)(h.h,Object(c.a)(m.rgb)):new h.h(1,1,1),terrainHeight:m.terrainHeight,orbitEntity:f,orbitRadius:m.orbitRadius,orbitDirection:m.orbitDirection,orbitSpeed:m.orbitSpeed,spinSpeed:m.spinSpeed}),t.next=15,b.create();case 15:Q.push(b),l.entity.add(b.entity);case 17:t.next=9;break;case 19:t.next=24;break;case 21:t.prev=21,t.t0=t.catch(7),p.e(t.t0);case 24:return t.prev=24,p.f(),t.finish(24);case 27:Q.push(l),P.add(l.entity);case 29:case"end":return t.stop()}}),t,null,[[7,21,24,27]])})),p=0;case 13:if(!(p<E.planets.length)){t.next=18;break}return t.delegateYield(l(p),"t0",15);case 15:p++,t.next=13;break;case 18:t.next=4;break;case 20:t.next=25;break;case 22:t.prev=22,t.t1=t.catch(2),a.e(t.t1);case 25:return t.prev=25,a.f(),t.finish(25);case 28:case"end":return t.stop()}}),t,null,[[2,22,25,28]])})));return function(){return t.apply(this,arguments)}}();X(),function t(){if(requestAnimationFrame(t),Q.forEach((function(t){t.animate(K)})),A.update(),N.update(),U>-1){var e=Q.find((function(t){return t.id===U}));if(e){var a=new h.H;e.sphere.getWorldPosition(a),T.position.set(a.x+2*e.radius,a.y+2*e.radius,a.z+8*e.radius),T.lookAt(a.x,a.y,a.z)}}W.render(P,T)}()},65:function(t,e,a){}},[[228,1,2]]]);
//# sourceMappingURL=main.e55b221b.chunk.js.map